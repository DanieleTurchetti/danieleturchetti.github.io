<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>lecture2b_manycontvar – course-notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">course-notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#lecture-2b---exploring-many-categorical-variables" id="toc-lecture-2b---exploring-many-categorical-variables" class="nav-link active" data-scroll-target="#lecture-2b---exploring-many-categorical-variables">Lecture 2b - Exploring Many Categorical Variables</a>
  <ul class="collapse">
  <li><a href="#scatterplots" id="toc-scatterplots" class="nav-link" data-scroll-target="#scatterplots">Scatterplots</a>
  <ul class="collapse">
  <li><a href="#example-london-olympic-athletes" id="toc-example-london-olympic-athletes" class="nav-link" data-scroll-target="#example-london-olympic-athletes">Example: London Olympic Athletes</a></li>
  <li><a href="#what-features-to-look-for" id="toc-what-features-to-look-for" class="nav-link" data-scroll-target="#what-features-to-look-for">What features to look for</a></li>
  <li><a href="#overplotting" id="toc-overplotting" class="nav-link" data-scroll-target="#overplotting">Overplotting</a></li>
  <li><a href="#example-old-faithful-again" id="toc-example-old-faithful-again" class="nav-link" data-scroll-target="#example-old-faithful-again">Example: Old Faithful (again)</a></li>
  <li><a href="#example-movie-ratings" id="toc-example-movie-ratings" class="nav-link" data-scroll-target="#example-movie-ratings">Example: Movie ratings</a></li>
  <li><a href="#comparing-groups-within-scatterplots" id="toc-comparing-groups-within-scatterplots" class="nav-link" data-scroll-target="#comparing-groups-within-scatterplots">Comparing groups within scatterplots</a></li>
  <li><a href="#example-london-olympic-athletes-1" id="toc-example-london-olympic-athletes-1" class="nav-link" data-scroll-target="#example-london-olympic-athletes-1">Example: London Olympic Athletes</a></li>
  </ul></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">Correlation</a></li>
  <li><a href="#many-continuous-variables" id="toc-many-continuous-variables" class="nav-link" data-scroll-target="#many-continuous-variables">Many continuous variables</a>
  <ul class="collapse">
  <li><a href="#scatterplots-vs-boxplots" id="toc-scatterplots-vs-boxplots" class="nav-link" data-scroll-target="#scatterplots-vs-boxplots">Scatterplots vs boxplots</a></li>
  <li><a href="#bubbleplots" id="toc-bubbleplots" class="nav-link" data-scroll-target="#bubbleplots">Bubbleplots</a></li>
  <li><a href="#example-swiss-banknotes" id="toc-example-swiss-banknotes" class="nav-link" data-scroll-target="#example-swiss-banknotes">Example: Swiss Banknotes</a></li>
  <li><a href="#parallel-coordinate-plots" id="toc-parallel-coordinate-plots" class="nav-link" data-scroll-target="#parallel-coordinate-plots">Parallel Coordinate Plots</a></li>
  <li><a href="#correlation-and-correlation-plot-corrplot" id="toc-correlation-and-correlation-plot-corrplot" class="nav-link" data-scroll-target="#correlation-and-correlation-plot-corrplot">Correlation and correlation plot (corrplot)</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="lecture-2b---exploring-many-categorical-variables" class="level1">
<h1>Lecture 2b - Exploring Many Categorical Variables</h1>
<p>In this lecture, we explore data sets with more than one continuous variable. The main aspects we are concerned with are:</p>
<ul>
<li>When studying the relationship between two numerical variables, the simplest and most powerful visualisation is the <strong>scatterplot</strong></li>
<li>When a third categorical variable is studied on top of the two numerical ones, one can either use colours (for fewer groups) or a grid or trellis of individual scatterplots (for larger groups)</li>
<li>Correlation is the appropriate summary statistic for assessing association, but it is limited to quantifying linear associations.</li>
</ul>
<p>As a motivation, we start by looking at the example of Fisher’s Iris data. We choose one continuous variable, say <code>Petal.Length</code>, and start our exploration with a simple histogram:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Petal.Length, <span class="at">breaks =</span> <span class="dv">30</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-1-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There is a clear separation in two distinct groups, but without further exploration we can’t conclude much. Luckily for us, we have other variables in the same data set: let us plot <code>Petal.Length</code> against <code>Petal.Width</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Petal Length"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Petal Width"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Petal Width vs Petal Length"</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-2-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From this simple plot, we reinforce our idea that at least two distinct group of observations are in our data set. Moreover, we can see a strong association, as flowers with longer petals show also a greater width of petals.</p>
<p>Let’s now exploit a third variable, <code>species</code>. This is a categorical variable, containing only three groups. A good solution is then to use colour:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">setosa =</span> <span class="st">"black"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">versicolor =</span> <span class="st">"yellow3"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">virginica =</span> <span class="st">"lightblue3"</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Petal Length"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Petal Width"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Petal Width vs Petal Length by Species"</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We discover that the two groups of observations correspond to</p>
<ol type="1">
<li>the irises of species setosa</li>
<li>the irises of the two other species.</li>
</ol>
<p>Moreover, we see that inside each group the correlation between petal length and petal width is much lower: the variable <code>species</code> determines a big proportion of the petal size, and once one knows that two given irises belong to a certain species, <code>Petal.Length</code> is less of a good predictor of <code>Petal.Width</code>.</p>
<pre><code>The takeout message of this example is that assessing more variables allows for the emergence of complex features of a data set.</code></pre>
<p>We are now going to see other examples of features of a data set with many continuous variables.</p>
<section id="scatterplots" class="level2">
<h2 class="anchored" data-anchor-id="scatterplots">Scatterplots</h2>
<p>Let’s start our exploration with scatterplots:</p>
<ul>
<li>Drawing <em>scatterplots</em> is one of the first things statisticians do when looking at data.</li>
<li>A scatterplot displays two quantitative variables against each other data by plotting each data points values as <span class="math inline">\((x,y)\)</span> coordinates.</li>
<li>Scatterplots can reveal <em>structure</em> not readily apparent from summaries, and are both <em>easy to present and interpret</em>.</li>
<li>The major role of scatterplots is in <em>exposing associations</em> between variables - not just linear associations, but <em>any</em> kind of association.</li>
<li>Scatterplots are also useful at <em>identifying outliers</em> and other <em>distributional features.</em></li>
<li>However, <em>marginal distributions</em> cannot always be easily seen from a scatterplot.</li>
</ul>
<section id="example-london-olympic-athletes" class="level3">
<h3 class="anchored" data-anchor-id="example-london-olympic-athletes">Example: London Olympic Athletes</h3>
<p>For example, let’s consider the Weight and Height of the 10,384 athletes competing in the London 2012 Olympics:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAMdata)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(oly12)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can draw a scatterplot of these variables using the <code>plot</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>oly12<span class="sc">$</span>Height, <span class="at">y=</span>oly12<span class="sc">$</span>Weight)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note the choice of which variable is drawn as the horizontal coordinate and which is the vertical.</p>
<p>The <code>plot</code> function accepts the usual arguments to customise the graphic.</p>
<ul>
<li><code>xlab</code>, <code>ylab</code>, <code>main</code> - axis labels and main title</li>
<li><code>xlim</code>, <code>ylim</code> - axis ranges, a vector of length two</li>
<li><code>pch</code> - changes the plot character, integer</li>
<li><code>col</code> - changes the point colour, either specifying one colour for all points or one colour for each point</li>
<li><code>cex</code> - relative point size, defaults to 1</li>
</ul>
<p>In particular, the plot character (<code>pch</code>) can be changed to something more solid to give a clearer picture.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>oly12<span class="sc">$</span>Height,<span class="at">y=</span>oly12<span class="sc">$</span>Weight,<span class="at">xlab=</span><span class="st">'Height'</span>, <span class="at">ylab=</span><span class="st">'Weight'</span>,<span class="at">main=</span><span class="st">''</span>,<span class="at">pch=</span><span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-features-to-look-for" class="level3">
<h3 class="anchored" data-anchor-id="what-features-to-look-for">What features to look for</h3>
<ul>
<li><strong>Relationships</strong> - associations between variables will manifest as trends (either linear or nonlinear) in a scatterplot. Here, we’re interested in the <em>nature</em>, <em>direction</em>, and <em>strength</em> of any discovered relationship</li>
<li><strong>Causal relationships</strong> - Great care should be taken to distinguish association from possible causation.</li>
<li><strong>Outliers or groups of outliers</strong> - Cases can be outliers in two dimensions without being outliers in the separate dimensions. Taller people are generally heavier, but a particularly heavy person of average height stands out more.</li>
<li><strong>Clusters</strong> - Groups of cases occurring separately from the rest of the data, such as the iris species in Fisher’s iris data.</li>
<li><strong>Granularity</strong> - Values may line up in regular columns or rows indicating some form of rounding or grouping of the data has occurred before analysis.</li>
<li><strong>Barriers</strong> - Some combinations of values may be impossible. Age cannot be negative, and years of employment cannot be more than Age.</li>
<li><strong>Gaps and holes</strong> - Some combinations of values may be theoretically possible, but do not occur in the data, e.g.&nbsp;very tall but very light people.</li>
<li><strong>Conditional relationships</strong> - sometimes the relationship can change fundamentally given another variable, e.g.&nbsp;income vs age will look quite different for working age and retired people, and iris flowers look different for different species.</li>
</ul>
<p>So, what do features do we see in this plot:</p>
<ul>
<li>There is a fairly strong positive relationship - taller athletes are heavier. This makes rather obvious sense. Sometimes part of statistical exploration is to confirm common-sense inutuitions and to reassure ourselves that the data are correctly recorded (and that any pre-conceptions we have are correct!)</li>
<li>Some <strong>outliers</strong> break this pattern - the single athlete with a weight over 200 is a rather heavy Judo player</li>
<li>Note how some points arrange themselves into parallel vertical and horizontal lines - this is because the data values have been rounded, which forces the points onto a grid of regular values and leaving gaps in between.</li>
<li>We have 10384 athletes in the data, but there area far fewer visible points here - this is a problem of <strong>over plotting</strong></li>
</ul>
</section>
<section id="overplotting" class="level3">
<h3 class="anchored" data-anchor-id="overplotting">Overplotting</h3>
<p><em>Overplotting</em> is a problem in a scatterplot where the drawn data points overlap one another. This typically occurs when there are a large number of data points and/or a small number of unique values in the dataset.</p>
<p>As multiple stacked points look the same as a single point, this makes it difficult to identify areas of <em>high density</em>. In the scatterplot above, we cannot tell if there is one person with a weight over 200 or one hundred.</p>
<p>Possible solutions include:</p>
<ul>
<li><em>Using transparency</em> - higher density is then evident by darker regions, where the degree of darkness is caused by the multiple overlapping points</li>
<li><em>Jittering</em> - add random noise to the points to turn the stacks into point clouds</li>
<li><em>Using smaller points</em> - only feasible for modestly sized problems.</li>
</ul>
<p>We can apply transparency to the scatterplot of the Olympic athletes as follows:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>oly12<span class="sc">$</span>Height,<span class="at">y=</span>oly12<span class="sc">$</span>Weight,<span class="at">xlab=</span><span class="st">'Height'</span>, <span class="at">ylab=</span><span class="st">'Weight'</span>,<span class="at">main=</span><span class="st">''</span>,<span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">alpha</span>(<span class="st">'black'</span>,<span class="fl">0.2</span>)) <span class="do">## this tells R to use 20% transparent black for each point</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now the areas of high density in the main cloud of data stand out as darker, and the more unusual values fade out.</p>
</section>
<section id="example-old-faithful-again" class="level3">
<h3 class="anchored" data-anchor-id="example-old-faithful-again">Example: Old Faithful (again)</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(geyser)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The Old Faithful geyser in Yellowstone National Park, Wyoming, USA which a very regular pattern of eruption.</p>
<p>Consider the duration of the eruptions and the waiting time until the next eruption.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span>geyser<span class="sc">$</span>waiting,<span class="at">x=</span>geyser<span class="sc">$</span>duration, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xlab=</span><span class="st">'duration'</span>,<span class="at">ylab=</span><span class="st">'waiting'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What can we see?</p>
<ul>
<li>Possible evidence of 2 or 3 clusters of points in the data</li>
<li>One cluster of shorter duration eruptions associated with a longer waiting time.</li>
<li>A further cluster (or two) of longer eruptions with a short or long waiting time.</li>
<li>Clear signs of rounding producing a line of data points with a duration of exactly 4. Definitely suspicious!</li>
</ul>
</section>
<section id="example-movie-ratings" class="level3">
<h3 class="anchored" data-anchor-id="example-movie-ratings">Example: Movie ratings</h3>
<p><i class="fa fa-database"></i> Download data: <a href="movies.Rda">movies</a></p>
<p>Most of the data sets we’ve seen so far are not very big. Consider instead the movies data set, which contained 24 variables and 58 788 cases corresponding to various attributes of different movies taken from IMDB. Let’s focus on two of the variables: the average IMDB user rating, and the number of users who rated that movie on IMDB.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>movies<span class="sc">$</span>votes, <span class="at">y=</span>movies<span class="sc">$</span>rating, <span class="at">ylab=</span><span class="st">"Rating"</span>, <span class="at">xlab=</span><span class="st">"Votes"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What do we see here?</p>
<ul>
<li>There are no films with many votes and very low average rating.</li>
<li>For films with more than a small number of votes, the average rating increases with number of votes.</li>
<li>No film with lots of votes has an average rating close to the maximum possible. There is almost an invisible barrier preventing very high scores.</li>
<li>A few films with a high number of votes (over 50 000) appear far from the rest of the data with unusually low ratings compared to others.</li>
<li>Films with a low number of votes may have any average ratin from the worst to the best.</li>
<li>The only films with high average ratings are films with relatively few votes.</li>
</ul>
<p>We can extract a lot of information from a scatterplot!</p>
</section>
<section id="comparing-groups-within-scatterplots" class="level3">
<h3 class="anchored" data-anchor-id="comparing-groups-within-scatterplots">Comparing groups within scatterplots</h3>
<p><em>Patterns and trends</em> observed within a scatterplot can often be explained by the action of other variables.</p>
<p>In particular, other <em>categorical variables</em> may induce different behaviours for each group (e.g.&nbsp;male and female).</p>
<ul>
<li>There are a variety of ways to explore and compare possible groupings:</li>
<li>Indicate the groups within the plot via <em>colour</em> or <em>plot symbol</em></li>
<li><em>Split</em> the data and <em>draw separate plots</em> for each potential group</li>
</ul>
<section id="example-fertility-in-developing-nations" class="level4">
<h4 class="anchored" data-anchor-id="example-fertility-in-developing-nations">Example: Fertility in developing nations</h4>
<p>Consider the average values of fertility (number of children per mother) versus percentage of contraceptors among women of childbearing age in developing nations around 1990.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(carData)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Robey)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span>Robey<span class="sc">$</span>tfr, <span class="at">x=</span>Robey<span class="sc">$</span>contraceptors, <span class="at">pch=</span><span class="dv">20</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">'Total fertility rate (children per woman)'</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Percent of contraceptors among married women of childbearing age'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-11-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>We find a rough straight line relationship for most of the points - suggests a negative linear association between fertility and contraceptor percentage</li>
<li>Still a lot of spread about the rough line, i.e.&nbsp;the relationship is clear but far from perfect.</li>
<li>Pragmatically, this seems to agree with the common-sense view that fertility declines on average as the percentage of contraceptors in a country rise.</li>
<li>Sometimes part of the job of exploring the dat is confirming the data agrees with what might be considered obvious - finding the opposite effect in the data would be far more surprising!</li>
</ul>
<p>The fertility data set also contains a third variable representing the region of the world, which we can indicate in colour.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span>Robey<span class="sc">$</span>tfr, <span class="at">x=</span>Robey<span class="sc">$</span>contraceptors, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col=</span>Robey<span class="sc">$</span>region,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">'Total fertility rate (children per woman)'</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Percent of contraceptors among married women of childbearing age'</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="st">'topright'</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">lwd=</span><span class="cn">NA</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nlevels</span>(Robey<span class="sc">$</span>region), <span class="at">legend=</span><span class="fu">levels</span>(Robey<span class="sc">$</span>region))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>This doesn’t seem to affect the overall conclusion, in that the pattern seems to be the same, and linear, in each region.</li>
<li>Sometimes, not finding anything is a useful thing to learn!</li>
</ul>
<p>We could have used a different symbol for each region, but this is generally less effective than colour:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y=</span>Robey<span class="sc">$</span>tfr, <span class="at">x=</span>Robey<span class="sc">$</span>contraceptors, <span class="at">pch=</span><span class="fu">as.numeric</span>(Robey<span class="sc">$</span>region),</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">'Total fertility rate (children per woman)'</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Percent of contraceptors among married women of childbearing age'</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="st">'topright'</span>,<span class="at">lwd=</span><span class="cn">NA</span>, <span class="at">pch=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nlevels</span>(Robey<span class="sc">$</span>region), <span class="at">legend=</span><span class="fu">levels</span>(Robey<span class="sc">$</span>region))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Colour creates more of a contrast, making it much easier to distinguish the groups</li>
<li>In general, stick to a single symbol - unless you must use black &amp; white, or you have multiple different grouping variables!</li>
</ul>
</section>
</section>
<section id="example-london-olympic-athletes-1" class="level3">
<h3 class="anchored" data-anchor-id="example-london-olympic-athletes-1">Example: London Olympic Athletes</h3>
<p>The Olympic athletes data set also could be investigated by using colour to represent Gender. This shows an expected differentiation between the two:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>oly12<span class="sc">$</span>Height,<span class="at">y=</span>oly12<span class="sc">$</span>Weight,<span class="at">xlab=</span><span class="st">'Height'</span>, <span class="at">ylab=</span><span class="st">'Weight'</span>,<span class="at">main=</span><span class="st">''</span>,<span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">alpha</span>(<span class="fu">c</span>(<span class="st">'#000000'</span>,<span class="st">'#ff0000'</span>),<span class="fl">0.2</span>)[oly12<span class="sc">$</span>Sex])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="st">'topleft'</span>, <span class="at">legend=</span><span class="fu">levels</span>(oly12<span class="sc">$</span>Sex), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Colouring the 42 sport categories is less helpful.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>oly12<span class="sc">$</span>Height,<span class="at">y=</span>oly12<span class="sc">$</span>Weight,<span class="at">xlab=</span><span class="st">'Height'</span>, <span class="at">ylab=</span><span class="st">'Weight'</span>,<span class="at">main=</span><span class="st">''</span>,<span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span>oly12<span class="sc">$</span>Sport)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-15-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Unfortunately, with many categories the differences between 42 colours become too subtle to detect easily. Colour is only useful when indicating a small number of groups.</p>
<p>In this case, a better solution is to break the data up and draw separate mini scatterplots for each of the 42 sports. This is called a <em>lattice</em>, <em>grid</em> or <em>trellis</em> of plots:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-16-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Though the plots are small, we can still see the key features.</li>
<li>The increasing trend is common across all sports.</li>
<li>For some sports, the relationship looks nonlinear.</li>
<li>The picture is less clear for Athletics, which groups a lot of very different events together.</li>
<li>Some sports seem to have very few or no athletes - we’re missing data on 1346 of the athletes.</li>
</ul>
</section>
</section>
<section id="correlation" class="level2">
<h2 class="anchored" data-anchor-id="correlation">Correlation</h2>
<p>The standard measure of the <em>strength</em> of <strong>linear relationship</strong> between two variables is the <strong>correlation coefficient</strong> . Assuming that we have <span class="math inline">\(n\)</span> pairs of observations <span class="math inline">\((x_1,y_1)\)</span>, …,<span class="math inline">\((x_n,y_n)\)</span>, the correlation coefficient is defined to be: [ r=_{i=1}^n()() ] In R, we can use the <code>cor</code> function to compute this.</p>
<p>The correlation can take any value between <span class="math inline">\(-1\)</span> and <span class="math inline">\(+1\)</span>, inclusive, with positive values representing positive correlation (as one variable increases, so does the other), and negative values representing negative correlation (as one variable increases, the other decreases). A correlation of <span class="math inline">\(0\)</span> means uncorrelated: no association (as one variable increases, the other doesn’t consistently increase or decrease).</p>
<p>Thus the value of <span class="math inline">\(r\)</span> can range from <span class="math inline">\(r=-1\)</span> (perfect negative correlation) through weaker negative correlation until <span class="math inline">\(r=0\)</span> (no correlation) through weak positive correlation to <span class="math inline">\(r=1\)</span> (perfect +ve correlation).</p>
<p>The correlation tells us two things:</p>
<ol type="1">
<li>the <strong>strength</strong> of association (strong, weak or zero);</li>
<li>the <strong>direction</strong> of association (negative or positive).</li>
</ol>
<p>For the fertility data:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">y=</span>Robey<span class="sc">$</span>tfr, <span class="at">x=</span>Robey<span class="sc">$</span>contraceptors)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9203109</code></pre>
</div>
</div>
<p>The value here is negative reflecting the negative aassociation - the increase in contraception corresponds to a reduction in numbers of children. The value itself is quite large (close to -1) which indicates a strong association - this is reflected by the fact the data are roughly organised along a straight line.</p>
<p>Difficulties with correlation:</p>
<ul>
<li><strong>Can be difficult to interpret numerically</strong>: a value of <span class="math inline">\(r = 0.7\)</span> can mean different strengths of association for different numbers of pairs of points. Generally, the more points there are, <strong>the lower the correlation has to be to indicate association</strong>.</li>
<li><strong>Strong correlations (near <span class="math inline">\(\pm 1\)</span>) are quite rare</strong>, especially if the size of the distributions is large. Weak correlations (near 0) are common. Quite small correlations can indicate a linear association if the size of distributions is large, though it is difficult to set a hard and fast rule.</li>
<li><span class="math inline">\(r\)</span> doesn’t tell us by <strong>how much a change in one variable affects change in the other</strong> - it just tells us the rough direction and degree of change. For that, you need a regression.</li>
<li>The correlation coefficient measures <strong>linear</strong> association, and so can be misleading when there is nonlinear association, or when their are outliers present.</li>
<li>For two separate scatter plots, the correlation coefficient might be numerically the same, but the <span class="math inline">\(x,y\)</span> relationship between the variables may be very different.</li>
</ul>
<p>Recall, for example, Anscombe’s quartet of data points:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(anscombe)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anscombe<span class="sc">$</span>x1, anscombe<span class="sc">$</span>y1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8164205</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anscombe<span class="sc">$</span>x2, anscombe<span class="sc">$</span>y2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8162365</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anscombe<span class="sc">$</span>x3, anscombe<span class="sc">$</span>y3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8162867</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anscombe<span class="sc">$</span>x4, anscombe<span class="sc">$</span>y4)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8165214</code></pre>
</div>
</div>
<p>Their correlations are almost the same (up to 2 decimal places), but the actual patterns of the points are quite different:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mai =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>anscombe<span class="sc">$</span>x1, <span class="at">y=</span>anscombe<span class="sc">$</span>y1,<span class="at">xlab=</span><span class="st">''</span>,<span class="at">ylab=</span><span class="st">''</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">14</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>anscombe<span class="sc">$</span>x2, <span class="at">y=</span>anscombe<span class="sc">$</span>y2,<span class="at">xlab=</span><span class="st">''</span>,<span class="at">ylab=</span><span class="st">''</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">14</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>anscombe<span class="sc">$</span>x3, <span class="at">y=</span>anscombe<span class="sc">$</span>y3,<span class="at">xlab=</span><span class="st">''</span>,<span class="at">ylab=</span><span class="st">''</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">14</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>anscombe<span class="sc">$</span>x4, <span class="at">y=</span>anscombe<span class="sc">$</span>y4,<span class="at">xlab=</span><span class="st">''</span>,<span class="at">ylab=</span><span class="st">''</span>,<span class="at">pch=</span><span class="dv">20</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">14</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-19-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="many-continuous-variables" class="level2">
<h2 class="anchored" data-anchor-id="many-continuous-variables">Many continuous variables</h2>
<p>Visualising large numbers of continuous variables has the potential to uncover enven more features, but also presents more challenges.</p>
<section id="scatterplots-vs-boxplots" class="level3">
<h3 class="anchored" data-anchor-id="scatterplots-vs-boxplots">Scatterplots vs boxplots</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris[,<span class="dv">4</span><span class="sc">:</span><span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-20-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Boxplots are effective for getting an overview of major differences between variables - particularly in terms of their location (position vertically) and scale (length of the boxplot). However, boxplots are too simple to show whether a variable splits into different modes or groups. Boxplots are also fundamentally a 1-dimensional graphic - they cannot detect or display whether the variables are related.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(iris[,<span class="dv">4</span><span class="sc">:</span><span class="dv">1</span>], <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-21-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Conversely, the scatterplot matrix exposes a great deal of the structure of the data, and makes relationships clear. Patterns, trends, and groups emerge quite easily and can be easily spotted by eye. But it is not as effective for comparing scales and locations - we still need the boxplots, even if they are limited!</p>
</section>
<section id="bubbleplots" class="level3">
<h3 class="anchored" data-anchor-id="bubbleplots">Bubbleplots</h3>
<p>What if we need to include a third numerical variable into a scatter plot? One way to achieve this is a <strong>bubble plot</strong>, where we use the value of a third variable to control the size of the points we draw on a scatterplot:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(iris, <span class="at">x=</span><span class="sc">~</span>Petal.Width, <span class="at">y=</span><span class="sc">~</span>Petal.Length, <span class="at">size=</span><span class="sc">~</span>Sepal.Width, <span class="at">color=</span><span class="sc">~</span>Species,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sizes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">50</span>), <span class="at">type=</span><span class="st">'scatter'</span>, <span class="at">mode=</span><span class="st">'markers'</span>, <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">opacity =</span> <span class="fl">0.7</span>, <span class="at">sizemode =</span> <span class="st">"diameter"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><img src="lec5-bubbleplot.png" style="height:35.0%"></p>
<p>Here we have positioned the points of the <code>iris</code> data according to the Petal measurements and used the size of the point to indicate the <code>Sepal.Width</code>. We can note that the orange points (versicolor) appear to have more small bubbles than the others, and the green points (setosa) look to have larger values.</p>
<p>This technique can be quite effective when the variable corresponding to point size corresponds to some measure of importance, scale, or size (such as population per country, number of samples in a survey, number of patients in a medical trial). While it can be effectively used in three-variable problems, for more variables than this we require other methods.</p>
<p>Dealing with more continuous variables will require scaling up a lot of the familiar techniques from earlier. Individual numerical summaries can still be computed, though it is even more difficult to easily compare. Some of the standard visualisations can be easily applied to many variables, such as histograms and box plots.</p>
<p>One particularly useful technique is to take scatterplots, and draw many of them in a matrix to effectively compare multiple variables at once. <em>Scatterplot matrices</em> are a matrix of scatterplots with each variable plotted against all of the others.</p>
<p>Like the grid or trellis scatterplot we produce an <em>array</em> of plots, but now we plot <em>all variables simultaneously</em>!</p>
<p>These give <em>excellent initial overviews</em> of the relationship between continuous variables in data sets with relatively small numbers of variables.</p>
</section>
<section id="example-swiss-banknotes" class="level3">
<h3 class="anchored" data-anchor-id="example-swiss-banknotes">Example: Swiss Banknotes</h3>
<p>Let’s use a data set on Swiss banknotes to illustrate variations we can make to a scatterplot matrix.</p>
<p>The data are six measurements on each of 100 genuine and 100 forged Swiss banknotes. The idea is to see if we can distinguish the real notes from the fakes on the basis of the notes dimensions only:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:VGAM':

    logit</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bank,<span class="at">package=</span><span class="st">"gclus"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatterplotMatrix</span>(bank[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">smooth=</span><span class="cn">FALSE</span>, <span class="at">regLine=</span><span class="cn">FALSE</span>, <span class="at">diagonal=</span><span class="cn">TRUE</span>, <span class="at">groups=</span>bank<span class="sc">$</span>Status,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">7</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">16</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-23-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:60.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Blue=Genuine, Yellow=Fake.</li>
<li>We can use the diagonal elements to show histograms (or smoothed histograms)</li>
<li>Can we see any variables for which the two groups are well separated? “Diagonal” looks like a good candidate. Looking at the (smoothed) histograms in the Diagonal panel, we can see the two distributions barely overlap indicating a useful variable for separating the groups.</li>
<li>We can see some assocations and relationships here “Left”/“Right” are positively correlated, but “Top”/“Diagonal” are negatively associated.</li>
<li>There also seem to be a few possible outliers, not all are forgeries!</li>
</ul>
</section>
<section id="parallel-coordinate-plots" class="level3">
<h3 class="anchored" data-anchor-id="parallel-coordinate-plots">Parallel Coordinate Plots</h3>
<p><strong>Parallel coordinate plots</strong> (PCP) have become a popular tool for highly-multivariate data.</p>
<p>Rather than using perpendicular axes for pairs of variables and points for data, we draw <em>all variables</em> on <strong>parallel vertical axes</strong> and <em>connect data with lines</em>.</p>
<p>The variables are <strong>standardised</strong>, so that a <em>common</em> vertical axis makes sense.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(iris[,<span class="dv">4</span><span class="sc">:</span><span class="dv">1</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">'#f8766d'</span>,<span class="st">'#00ba38'</span>,<span class="st">'#619cff'</span>)[iris<span class="sc">$</span>Species])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-24-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parallelplot</span>(iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">col=</span><span class="fu">c</span>(<span class="st">'#f8766d'</span>,<span class="st">'#00ba38'</span>,<span class="st">'#619cff'</span>)[iris<span class="sc">$</span>Species], <span class="at">horizontal=</span><span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-24-2.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In general:</p>
<ul>
<li><p>Each line represents one data point.</p></li>
<li><p>The height of each line above the variable label indicates the (relative) size of the value for that data point. The variables are transformed to a common scale to make comparison possible.</p></li>
<li><p>All the values for one observation are connected across the plot, so we can see how things change for individuals as we move from one variable to another. Note that this is sensitive to the ordering we choose for the variables in the plot – some orderings of the variables may give clearer pictures than others.</p></li>
</ul>
<p>For these data:</p>
<ul>
<li><p>We can see how the setosa species (red) is <em>separated</em> from the others on the Petal measurements in the PCP by the separation between the group of red lines and the rest.</p></li>
<li><p>Setosa (red) is also generally smaller than the others, except on Sepal Width where it is larger than the other species.</p></li>
<li><p>We can also pick out <em>outliers</em>, for instance one setosa iris has a particularly small value of Sepal Width compared to all the others.</p></li>
</ul>
<p>Using parallel coordinate plots:</p>
<ul>
<li><p>Reading and interpreting a parallel coordinate plot (PCP) is a bit more <em>difficult</em> than a scatterplot, but can be just as effective for bigger problems.</p></li>
<li><p>When we identify interesting features, we can then investigate them using <em>more familiar graphics</em>.</p></li>
<li><p>A PCP gives a quick overview of the <em>univariate distribution</em> for each variable, and so we can identify skewness, outliers, gaps and concentrations.</p></li>
<li><p>However, for <em>pairwise properties and associations</em> then it’s best to draw a scatterplot.</p></li>
</ul>
<section id="example-guardian-university-league-table-2013" class="level4">
<h4 class="anchored" data-anchor-id="example-guardian-university-league-table-2013">Example: Guardian university league table 2013</h4>
<p>The Guardian newspaper in the UK publishes a ranking of British universities each year and it reported these data in May, 2012 as a guide for 2013. 120 Universities are ranked using a combination of 8 criteria, combined into an ‘Average Teaching Score’ used to form the ranking.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GDAdata)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(uniranks)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="do">## a little bit of data tidying</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(uniranks)[<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">13</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'AvTeach'</span>,<span class="st">'NSSTeach'</span>,<span class="st">'SpendPerSt'</span>,<span class="st">'Careers'</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">'VAddScore'</span>,<span class="st">'NSSFeedb'</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>uniranks1 <span class="ot">&lt;-</span> <span class="fu">within</span>(uniranks, StaffStu <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(StudentStaffRatio))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="do">## draw the scatterplot matrix</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(uniranks1[,<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">14</span>)])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-25-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see some obvious patterns and dependencies here. What about the parallel coordinate plot?</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parallelplot</span>(uniranks1[,<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">14</span>)], <span class="at">col=</span><span class="st">'black'</span>,  <span class="at">horizontal=</span><span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-26-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Can we learn anything from this crazy mess of spaghetti?</p>
<p>PCPs are most effective if we colour the lines to represent subgroups of the data. We can colour the Russell Group universities, which unsurprisingly are usually at the top (except on NSSFeedback!)</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create a new variable to represent the group we want</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>uniranks2 <span class="ot">&lt;-</span> <span class="fu">within</span>(uniranks1,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                    Rus <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(UniGroup<span class="sc">==</span><span class="st">"Russell"</span>, <span class="st">"Russell"</span>, <span class="st">"not"</span>)))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">parallelplot</span>(uniranks2[,<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">14</span>)], <span class="at">col=</span><span class="fu">c</span>(<span class="st">"#2297E6"</span>,<span class="st">"#DF536B"</span>)[uniranks2<span class="sc">$</span>Rus],  <span class="at">horizontal=</span><span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-27-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Using colour helps us to diffentiate the lines from the different data points more clearly. Now we can start to explore for features and patterns:</p>
<ul>
<li><em>AvTeach</em> is the overall ranking, so notice how high/low values here are connected to high/low values elsewhere.</li>
<li>There are some exceptions - the 3rd ranked university on AvTeach has a surprisingly low NSSTeaching score (note the rapidly descending red line)</li>
<li>Notice how the data ‘pinch’ at certain values on NSS Teach and NSSOverall leaving gaps - this suggests a granularity effect due to limited options of values on the NSS survey scores, e.g.&nbsp;integer scores out of 10. This creates <em>heaping</em> and <em>gaps</em> in the data values as the data is really ordinal.</li>
<li>Also, notice how most of the lines are moving upwards when connecting these NSSTeach and NSSOverall - this would suggest a positive correlation.</li>
<li>The extremes of these two NSS scores are rarely observed, and they also correspond strongly to extremes on the overall score and ranking.</li>
<li>The heavy concentration on low values on EntryTariff (entry requirements) and StaffStu (staff:student ratio) suggests strong skewness in the distributions</li>
</ul>
<p>A scatterplot matrix corroborates most of these features, though we’re probably near the limit of what we can read and extract from such a plot!</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(uniranks2[,<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">14</span>)],<span class="at">col=</span><span class="fu">c</span>(<span class="st">"#2297E6"</span>,<span class="st">"#DF536B"</span>)[uniranks2<span class="sc">$</span>Rus], <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-28-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="correlation-and-correlation-plot-corrplot" class="level3">
<h3 class="anchored" data-anchor-id="correlation-and-correlation-plot-corrplot">Correlation and correlation plot (corrplot)</h3>
<ul>
<li>The scatterplot matrix is easily overloaded with many variables and cases.</li>
<li>Correlations provide a useful numerical summary, and the corrplot is a good way to visualise that information.</li>
<li>Note that the standard correlation coefficient is not a good measure of non-linear relationships or suitable for categorical variables! Alternative correlations exist for such variables, but these are not computed by default.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(Boston),<span class="dv">2</span>) <span class="do">## round to 2dp</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         crim    zn indus  chas   nox    rm   age   dis   rad   tax ptratio
crim     1.00 -0.20  0.41 -0.06  0.42 -0.22  0.35 -0.38  0.63  0.58    0.29
zn      -0.20  1.00 -0.53 -0.04 -0.52  0.31 -0.57  0.66 -0.31 -0.31   -0.39
indus    0.41 -0.53  1.00  0.06  0.76 -0.39  0.64 -0.71  0.60  0.72    0.38
chas    -0.06 -0.04  0.06  1.00  0.09  0.09  0.09 -0.10 -0.01 -0.04   -0.12
nox      0.42 -0.52  0.76  0.09  1.00 -0.30  0.73 -0.77  0.61  0.67    0.19
rm      -0.22  0.31 -0.39  0.09 -0.30  1.00 -0.24  0.21 -0.21 -0.29   -0.36
age      0.35 -0.57  0.64  0.09  0.73 -0.24  1.00 -0.75  0.46  0.51    0.26
dis     -0.38  0.66 -0.71 -0.10 -0.77  0.21 -0.75  1.00 -0.49 -0.53   -0.23
rad      0.63 -0.31  0.60 -0.01  0.61 -0.21  0.46 -0.49  1.00  0.91    0.46
tax      0.58 -0.31  0.72 -0.04  0.67 -0.29  0.51 -0.53  0.91  1.00    0.46
ptratio  0.29 -0.39  0.38 -0.12  0.19 -0.36  0.26 -0.23  0.46  0.46    1.00
black   -0.39  0.18 -0.36  0.05 -0.38  0.13 -0.27  0.29 -0.44 -0.44   -0.18
lstat    0.46 -0.41  0.60 -0.05  0.59 -0.61  0.60 -0.50  0.49  0.54    0.37
medv    -0.39  0.36 -0.48  0.18 -0.43  0.70 -0.38  0.25 -0.38 -0.47   -0.51
        black lstat  medv
crim    -0.39  0.46 -0.39
zn       0.18 -0.41  0.36
indus   -0.36  0.60 -0.48
chas     0.05 -0.05  0.18
nox     -0.38  0.59 -0.43
rm       0.13 -0.61  0.70
age     -0.27  0.60 -0.38
dis      0.29 -0.50  0.25
rad     -0.44  0.49 -0.38
tax     -0.44  0.54 -0.47
ptratio -0.18  0.37 -0.51
black    1.00 -0.37  0.33
lstat   -0.37  1.00 -0.74
medv     0.33 -0.74  1.00</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(Boston))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Lecture2b_ManyContVar_files/figure-html/unnamed-chunk-30-1.png" class="quarto-figure quarto-figure-center figure-img" style="height:40.0%" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are clearly strong associations between <code>age</code> and <code>dis</code>, <code>indus</code> and <code>dis</code>, and <code>lstat</code> and <code>medv</code> that may be worth studying closer. <code>chas</code> appears almost uncorrelated to all the other variables – but remember <code>chas</code> was a binary variable, and so the correlation coefficient is meaningless here and we should not draw conclusions from this feature!</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>