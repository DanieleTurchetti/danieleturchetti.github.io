<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Multilevel Modelling Practical 2 (Week 3) | MLM_worksheets.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Multilevel Modelling Practical 2 (Week 3) | MLM_worksheets.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Multilevel Modelling Practical 2 (Week 3) | MLM_worksheets.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multilevel-modelling-practical-1-week-2.html"/>
<link rel="next" href="multilevel-modelling-practical-3-week-4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Home</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to multilevel modelling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#including-plots"><i class="fa fa-check"></i><b>1.1</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multilevel-modelling-practical-1-week-2.html"><a href="multilevel-modelling-practical-1-week-2.html"><i class="fa fa-check"></i><b>2</b> Multilevel Modelling Practical 1 (Week 2)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="multilevel-modelling-practical-1-week-2.html"><a href="multilevel-modelling-practical-1-week-2.html#instructions-start-here"><i class="fa fa-check"></i><b>2.1</b> Instructions – start here!</a></li>
<li class="chapter" data-level="2.2" data-path="multilevel-modelling-practical-1-week-2.html"><a href="multilevel-modelling-practical-1-week-2.html#exercises-1"><i class="fa fa-check"></i><b>2.2</b> Exercises 1</a></li>
<li class="chapter" data-level="2.3" data-path="multilevel-modelling-practical-1-week-2.html"><a href="multilevel-modelling-practical-1-week-2.html#exercises-2"><i class="fa fa-check"></i><b>2.3</b> Exercises 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html"><i class="fa fa-check"></i><b>3</b> Multilevel Modelling Practical 2 (Week 3)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#instructions-start-here-1"><i class="fa fa-check"></i><b>3.1</b> Instructions – start here!</a></li>
<li class="chapter" data-level="3.2" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#exercises-1-1"><i class="fa fa-check"></i><b>3.2</b> Exercises 1</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#acquire-and-prepare-data"><i class="fa fa-check"></i><b>3.2.1</b> Acquire and prepare data</a></li>
<li class="chapter" data-level="3.2.2" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#exploratory-analysis"><i class="fa fa-check"></i><b>3.2.2</b> Exploratory analysis</a></li>
<li class="chapter" data-level="3.2.3" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#naive-simple-linear-regression-models"><i class="fa fa-check"></i><b>3.2.3</b> Naive simple linear regression models</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#exercise-2"><i class="fa fa-check"></i><b>3.3</b> Exercise 2</a></li>
<li class="chapter" data-level="3.4" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#exercise-3-if-time"><i class="fa fa-check"></i><b>3.4</b> Exercise 3 (if time)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html"><i class="fa fa-check"></i><b>4</b> Multilevel Modelling Practical 3 (Week 4)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#instructions-start-here-2"><i class="fa fa-check"></i><b>4.1</b> Instructions – start here!</a></li>
<li class="chapter" data-level="4.2" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#exercise-1"><i class="fa fa-check"></i><b>4.2</b> Exercise 1</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#preparation-of-the-data-set"><i class="fa fa-check"></i><b>4.2.1</b> Preparation of the data set</a></li>
<li class="chapter" data-level="4.2.2" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#fitting-the-random-intercept-and-slope-model"><i class="fa fa-check"></i><b>4.2.2</b> Fitting the random intercept and slope model</a></li>
<li class="chapter" data-level="4.2.3" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#fitted-lines-by-class"><i class="fa fa-check"></i><b>4.2.3</b> Fitted lines by class</a></li>
<li class="chapter" data-level="4.2.4" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#the-intercept-only-empty-model-and-icc"><i class="fa fa-check"></i><b>4.2.4</b> The intercept-only / empty model and ICC</a></li>
<li class="chapter" data-level="4.2.5" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#the-random-intercept-model-with-covariate"><i class="fa fa-check"></i><b>4.2.5</b> The random intercept model (with covariate)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#exercise-2-1"><i class="fa fa-check"></i><b>4.3</b> Exercise 2</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#preparation"><i class="fa fa-check"></i><b>4.3.1</b> Preparation</a></li>
<li class="chapter" data-level="4.3.2" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#the-random-intercept-model"><i class="fa fa-check"></i><b>4.3.2</b> The random intercept model</a></li>
<li class="chapter" data-level="4.3.3" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#diagnostics"><i class="fa fa-check"></i><b>4.3.3</b> Diagnostics</a></li>
<li class="chapter" data-level="4.3.4" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#include-a-second-fixed-effect-variable-gender"><i class="fa fa-check"></i><b>4.3.4</b> Include a second fixed effect variable: gender</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html"><i class="fa fa-check"></i><b>5</b> Multilevel Modelling Practical 4 (Week 5)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#instructions-start-here-3"><i class="fa fa-check"></i><b>5.1</b> Instructions – start here!</a></li>
<li class="chapter" data-level="5.2" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#exercise-1-analysis-of-the-active-time-study-data-lecture-5"><i class="fa fa-check"></i><b>5.2</b> Exercise 1: Analysis of the Active Time study data (lecture 5)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#how-important-is-group-structure-vpcs-and-iccs"><i class="fa fa-check"></i><b>5.2.1</b> How important is group structure? (VPCs and ICCs)</a></li>
<li class="chapter" data-level="5.2.2" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#three-level-model-with-explanatory-variables"><i class="fa fa-check"></i><b>5.2.2</b> Three level Model with explanatory variables</a></li>
<li class="chapter" data-level="5.2.3" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#comparison-of-empty-model-with-model-with-explanatory-variables"><i class="fa fa-check"></i><b>5.2.3</b> Comparison of empty model with model with explanatory variables</a></li>
<li class="chapter" data-level="5.2.4" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#further-analysis-bottom-up-approach"><i class="fa fa-check"></i><b>5.2.4</b> Further analysis (bottom up approach)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multilevel-modelling-practical-5-week-6.html"><a href="multilevel-modelling-practical-5-week-6.html"><i class="fa fa-check"></i><b>6</b> Multilevel Modelling Practical 5 (Week 6)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multilevel-modelling-practical-5-week-6.html"><a href="multilevel-modelling-practical-5-week-6.html#instructions---start-here"><i class="fa fa-check"></i><b>6.1</b> Instructions - start here!</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="multilevel-modelling-practical-5-week-6.html"><a href="multilevel-modelling-practical-5-week-6.html#overview"><i class="fa fa-check"></i><b>6.1.1</b> Overview</a></li>
<li class="chapter" data-level="6.1.2" data-path="multilevel-modelling-practical-5-week-6.html"><a href="multilevel-modelling-practical-5-week-6.html#multilevel-modelling-with-longitudinal-data"><i class="fa fa-check"></i><b>6.1.2</b> Multilevel modelling with longitudinal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html"><i class="fa fa-check"></i><b>7</b> Multilevel Modelling Practical 6 (Week 7)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#instructions---start-here-1"><i class="fa fa-check"></i><b>7.1</b> Instructions - start here!</a></li>
<li class="chapter" data-level="7.2" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#exercise-1-long-and-wide-data-shape"><i class="fa fa-check"></i><b>7.2</b> Exercise 1 (Long and wide data shape)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#regression-vs-multilevel-analysis"><i class="fa fa-check"></i><b>7.2.1</b> Regression vs multilevel analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#exercise-2-simulation-from-the-two-level-longitudinal-model"><i class="fa fa-check"></i><b>7.3</b> Exercise 2 (simulation from the two-level longitudinal model)</a></li>
<li class="chapter" data-level="7.4" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#end-of-lab"><i class="fa fa-check"></i><b>7.4</b> End of lab!</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html"><i class="fa fa-check"></i><b>8</b> Multilevel Modelling Practical 7 (Week 8)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#instructions---start-here-2"><i class="fa fa-check"></i><b>8.1</b> Instructions - start here!</a></li>
<li class="chapter" data-level="8.2" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#exercise-1-aids-data-example-2-from-lecture-7"><i class="fa fa-check"></i><b>8.2</b> Exercise 1 (Aids data: Example 2 from lecture 7)</a></li>
<li class="chapter" data-level="8.3" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#exercise-2-leukaemia-data-example-3-from-lecture-7"><i class="fa fa-check"></i><b>8.3</b> Exercise 2 (Leukaemia data: Example 3 from lecture 7)</a></li>
<li class="chapter" data-level="8.4" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#exercise-3-toxoplasmosis-data-binomial-logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Exercise 3: Toxoplasmosis data (Binomial logistic regression)</a></li>
<li class="chapter" data-level="8.5" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#end-of-lab-1"><i class="fa fa-check"></i><b>8.5</b> ## End of lab!</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html"><i class="fa fa-check"></i><b>9</b> Multilevel Modelling Practical 8 (Week 9)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#instructions---start-here-3"><i class="fa fa-check"></i><b>9.1</b> Instructions - start here!</a></li>
<li class="chapter" data-level="9.2" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#preliminaries"><i class="fa fa-check"></i><b>9.2</b> Preliminaries</a></li>
<li class="chapter" data-level="9.3" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#exercise-1-betablocker-data"><i class="fa fa-check"></i><b>9.3</b> Exercise 1: Betablocker data</a></li>
<li class="chapter" data-level="9.4" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#exercise-2-digging-deeper"><i class="fa fa-check"></i><b>9.4</b> Exercise 2 (digging deeper)</a></li>
<li class="chapter" data-level="9.5" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#exercise-3-optional-toxoplasmosis-data-revisited"><i class="fa fa-check"></i><b>9.5</b> Exercise 3 (optional): Toxoplasmosis data revisited</a></li>
<li class="chapter" data-level="9.6" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#summative-assessment"><i class="fa fa-check"></i><b>9.6</b> Summative assessment</a></li>
<li class="chapter" data-level="9.7" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#end-of-lab-2"><i class="fa fa-check"></i><b>9.7</b> ## End of lab!</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multilevel-modelling-practical-9-week-10.html"><a href="multilevel-modelling-practical-9-week-10.html"><i class="fa fa-check"></i><b>10</b> Multilevel Modelling Practical 9 (Week 10)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multilevel-modelling-practical-9-week-10.html"><a href="multilevel-modelling-practical-9-week-10.html#dealing-with-missing-values"><i class="fa fa-check"></i><b>10.1</b> Dealing with missing values</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multilevel-modelling-practical-2-week-3" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Multilevel Modelling Practical 2 (Week 3)<a href="multilevel-modelling-practical-2-week-3.html#multilevel-modelling-practical-2-week-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="instructions-start-here-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Instructions – start here!<a href="multilevel-modelling-practical-2-week-3.html#instructions-start-here-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first part of this notebook (<strong>Exercise 1</strong>) reproduces the images displayed through the use of <code>ggplot</code> in Lecture 3 of this module. The code in this example is influenced by <a href="https://www.rensvandeschoot.com/tutorials/lme4/" class="uri">https://www.rensvandeschoot.com/tutorials/lme4/</a>.</p>
<p>The second part of the notebook (<strong>Exercise 2</strong>) allows you to test your <code>ggplot2</code> skills. If time permits, you may apply ggplot2 more freely onto another data set (<strong>Exercise 3</strong>).</p>
<p>We initially load two useful R packages (<em>haven</em>, <em>ggplot2</em>).</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="multilevel-modelling-practical-2-week-3.html#cb39-1" tabindex="-1"></a><span class="co">#You may need to install these packages!</span></span>
<span id="cb39-2"><a href="multilevel-modelling-practical-2-week-3.html#cb39-2" tabindex="-1"></a><span class="fu">require</span>(haven)      <span class="co"># to load the SPSS .sav file</span></span>
<span id="cb39-3"><a href="multilevel-modelling-practical-2-week-3.html#cb39-3" tabindex="-1"></a><span class="fu">require</span>(ggplot2)    <span class="co"># used for production of graphs</span></span></code></pre></div>
<p>If you don’t have the above packages, you will need to use the usual <code>install.packages()</code> and <code>library()</code> for both.</p>
</div>
<div id="exercises-1-1" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Exercises 1<a href="multilevel-modelling-practical-2-week-3.html#exercises-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="acquire-and-prepare-data" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Acquire and prepare data<a href="multilevel-modelling-practical-2-week-3.html#acquire-and-prepare-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the code below to reproduce the images from the lecture. Please do not just click your way through: try to understand and appreciate what the code does in all instances, and try to execute minor modifications of the code to observe the effect.</p>
<p>The following command is reading the data in directly from Andy’s Github page.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="multilevel-modelling-practical-2-week-3.html#cb40-1" tabindex="-1"></a>pop.rawdata <span class="ot">&lt;-</span> </span>
<span id="cb40-2"><a href="multilevel-modelling-practical-2-week-3.html#cb40-2" tabindex="-1"></a>   <span class="fu">read_sav</span>(<span class="at">file=</span><span class="st">&quot;https://andygolightly.github.io/teaching/MATH43515/popular2.sav&quot;</span>)</span></code></pre></div>
<p><span class="math inline">\(~\)</span></p>
<p>We extract the relevant columns, relabel accordingly, and display the first six rows.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="multilevel-modelling-practical-2-week-3.html#cb41-1" tabindex="-1"></a>pop.data <span class="ot">&lt;-</span> pop.rawdata[,<span class="fu">c</span>(<span class="st">&quot;pupil&quot;</span>, <span class="st">&quot;class&quot;</span>, <span class="st">&quot;extrav&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;texp&quot;</span>, <span class="st">&quot;popular&quot;</span>)]</span>
<span id="cb41-2"><a href="multilevel-modelling-practical-2-week-3.html#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="multilevel-modelling-practical-2-week-3.html#cb41-3" tabindex="-1"></a><span class="fu">colnames</span>(pop.data)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pupil&quot;</span>, <span class="st">&quot;class&quot;</span>, <span class="st">&quot;extraversion&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;experience&quot;</span>, <span class="st">&quot;popularity&quot;</span>)</span>
<span id="cb41-4"><a href="multilevel-modelling-practical-2-week-3.html#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="multilevel-modelling-practical-2-week-3.html#cb41-5" tabindex="-1"></a><span class="fu">head</span>(pop.data) <span class="co"># we have a look at the first 6 observations</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   pupil class extraversion gender    experience popularity
##   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl+lbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1     1     1            5 1 [girl]          24        6.3
## 2     2     1            7 0 [boy]           24        4.9
## 3     3     1            4 1 [girl]          24        5.3
## 4     4     1            3 1 [girl]          24        4.7
## 5     5     1            5 1 [girl]          24        6  
## 6     6     1            4 0 [boy]           24        4.7</code></pre>
<p>The following creates some auxiliary data frames, purely for visualization purpopses.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="multilevel-modelling-practical-2-week-3.html#cb43-1" tabindex="-1"></a>Ex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(pop.data<span class="sc">$</span>extraversion))</span>
<span id="cb43-2"><a href="multilevel-modelling-practical-2-week-3.html#cb43-2" tabindex="-1"></a><span class="fu">colnames</span>(Ex) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;extraversion&quot;</span>, <span class="st">&quot;frequency&quot;</span>)</span>
<span id="cb43-3"><a href="multilevel-modelling-practical-2-week-3.html#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="multilevel-modelling-practical-2-week-3.html#cb43-4" tabindex="-1"></a>Gen <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(pop.data<span class="sc">$</span>gender))</span>
<span id="cb43-5"><a href="multilevel-modelling-practical-2-week-3.html#cb43-5" tabindex="-1"></a><span class="fu">colnames</span>(Gen) <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;gender&quot;</span>, <span class="st">&quot;frequency&quot;</span>)</span>
<span id="cb43-6"><a href="multilevel-modelling-practical-2-week-3.html#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="multilevel-modelling-practical-2-week-3.html#cb43-7" tabindex="-1"></a>Tex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(pop.data<span class="sc">$</span>experience))</span>
<span id="cb43-8"><a href="multilevel-modelling-practical-2-week-3.html#cb43-8" tabindex="-1"></a><span class="fu">colnames</span>(Tex) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;experience&quot;</span>, <span class="st">&quot;frequency&quot;</span>)</span></code></pre></div>
</div>
<div id="exploratory-analysis" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Exploratory analysis<a href="multilevel-modelling-practical-2-week-3.html#exploratory-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Produce a histogram of the response variable.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="multilevel-modelling-practical-2-week-3.html#cb44-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pop.data, <span class="fu">aes</span>(popularity)) <span class="sc">+</span> </span>
<span id="cb44-2"><a href="multilevel-modelling-practical-2-week-3.html#cb44-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">15</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p><strong>TASK</strong>: Try <code>col="black", fill="light blue"</code> inside <code>geom_histogram()</code>.</p>
<p><span class="math inline">\(~\)</span></p>
<p>Visualise the explanatory variables as follows.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="multilevel-modelling-practical-2-week-3.html#cb45-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Ex, <span class="fu">aes</span>(<span class="at">x=</span>extraversion, <span class="at">y=</span>frequency)) <span class="sc">+</span> </span>
<span id="cb45-2"><a href="multilevel-modelling-practical-2-week-3.html#cb45-2" tabindex="-1"></a>   <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="multilevel-modelling-practical-2-week-3.html#cb46-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Gen, <span class="fu">aes</span>(<span class="at">x=</span>gender, <span class="at">y=</span>frequency)) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="multilevel-modelling-practical-2-week-3.html#cb46-2" tabindex="-1"></a>   <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="multilevel-modelling-practical-2-week-3.html#cb47-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Tex, <span class="fu">aes</span>(<span class="at">x=</span>experience, <span class="at">y=</span>frequency)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="multilevel-modelling-practical-2-week-3.html#cb47-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
<p><strong>TASK</strong>: What does <code>stat="identity"</code> do? Check the help file via <code>?geom_bar</code>.</p>
<p><span class="math inline">\(~\)</span></p>
<p>Scatterplot of popularity against extraversion and Pearson correlation:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="multilevel-modelling-practical-2-week-3.html#cb48-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pop.data, <span class="fu">aes</span>(<span class="at">x =</span> extraversion, <span class="at">y =</span> popularity)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="multilevel-modelling-practical-2-week-3.html#cb48-2" tabindex="-1"></a>       <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.2</span>,<span class="at">alpha =</span> .<span class="dv">8</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="multilevel-modelling-practical-2-week-3.html#cb49-1" tabindex="-1"></a><span class="fu">cor</span>(pop.data<span class="sc">$</span>extraversion, pop.data<span class="sc">$</span>popularity)</span></code></pre></div>
<pre><code>## [1] 0.3157935</code></pre>
<p><strong>TASK</strong>: What does <code>size</code> and <code>alpha</code> do in <code>geom_point()</code>?</p>
<p><span class="math inline">\(~\)</span></p>
<p>Scatterplot of popularity against gender and Pearson correlation:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="multilevel-modelling-practical-2-week-3.html#cb51-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data  =</span> pop.data, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> popularity, <span class="at">group=</span>gender)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="multilevel-modelling-practical-2-week-3.html#cb51-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="multilevel-modelling-practical-2-week-3.html#cb52-1" tabindex="-1"></a><span class="fu">cor</span>(pop.data<span class="sc">$</span>gender, pop.data<span class="sc">$</span>popularity)</span></code></pre></div>
<pre><code>## [1] 0.5682754</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="multilevel-modelling-practical-2-week-3.html#cb54-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pop.data, </span>
<span id="cb54-2"><a href="multilevel-modelling-practical-2-week-3.html#cb54-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x   =</span> extraversion, <span class="at">y =</span> popularity, <span class="at">colour =</span> <span class="fu">as.factor</span>(gender))</span>
<span id="cb54-3"><a href="multilevel-modelling-practical-2-week-3.html#cb54-3" tabindex="-1"></a>       ) <span class="sc">+</span>  </span>
<span id="cb54-4"><a href="multilevel-modelling-practical-2-week-3.html#cb54-4" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Let’s calculate the mean popularity and mean teacher experience score within each class and store in a data frame. Although no actual averaging takes place when calculating the teacher experience means, the code is useful for the extraction of the class level variable.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="multilevel-modelling-practical-2-week-3.html#cb55-1" tabindex="-1"></a>pop.means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pop.data<span class="sc">$</span>popularity, pop.data<span class="sc">$</span>class, mean) </span>
<span id="cb55-2"><a href="multilevel-modelling-practical-2-week-3.html#cb55-2" tabindex="-1"></a>    <span class="co"># average popularity per class</span></span>
<span id="cb55-3"><a href="multilevel-modelling-practical-2-week-3.html#cb55-3" tabindex="-1"></a>exp.means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(pop.data<span class="sc">$</span>experience, pop.data<span class="sc">$</span>class, mean)</span>
<span id="cb55-4"><a href="multilevel-modelling-practical-2-week-3.html#cb55-4" tabindex="-1"></a>    <span class="co"># extracting the upper-level variable teaching experience</span></span>
<span id="cb55-5"><a href="multilevel-modelling-practical-2-week-3.html#cb55-5" tabindex="-1"></a>    <span class="co"># (no actual averaging takes place here, as experience is constant within classes)</span></span>
<span id="cb55-6"><a href="multilevel-modelling-practical-2-week-3.html#cb55-6" tabindex="-1"></a>class.level<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pop.means=</span>pop.means, <span class="at">exp.means=</span>exp.means)</span>
<span id="cb55-7"><a href="multilevel-modelling-practical-2-week-3.html#cb55-7" tabindex="-1"></a></span>
<span id="cb55-8"><a href="multilevel-modelling-practical-2-week-3.html#cb55-8" tabindex="-1"></a><span class="co"># Plot mean popularity per class against teacher experience</span></span>
<span id="cb55-9"><a href="multilevel-modelling-practical-2-week-3.html#cb55-9" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> class.level, <span class="fu">aes</span>(<span class="at">x=</span>exp.means, <span class="at">y=</span> pop.means)) <span class="sc">+</span></span>
<span id="cb55-10"><a href="multilevel-modelling-practical-2-week-3.html#cb55-10" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb55-11"><a href="multilevel-modelling-practical-2-week-3.html#cb55-11" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;mean popularity per class&quot;</span>) <span class="sc">+</span> </span>
<span id="cb55-12"><a href="multilevel-modelling-practical-2-week-3.html#cb55-12" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;teacher experience&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p><strong>Task</strong>: make clear to yourself the use of <code>tapply()</code> here.</p>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="naive-simple-linear-regression-models" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Naive simple linear regression models<a href="multilevel-modelling-practical-2-week-3.html#naive-simple-linear-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s fit a single regression model to all data. The model takes the form
<span class="math display">\[
y_{ij}=a + b x_{ij}+ \epsilon_{ij}, \quad \epsilon_{ij}\sim N(0,\sigma^2), \quad i=1,\ldots,n_j,\quad j=1,\ldots,100.
\]</span>
We fit the model and extract estimates of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> as follows.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="multilevel-modelling-practical-2-week-3.html#cb56-1" tabindex="-1"></a>simple.linear.model<span class="ot">&lt;-</span> <span class="fu">lm</span>(popularity <span class="sc">~</span> extraversion, <span class="at">data=</span>pop.data)</span>
<span id="cb56-2"><a href="multilevel-modelling-practical-2-week-3.html#cb56-2" tabindex="-1"></a><span class="fu">summary</span>(simple.linear.model)<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##               Estimate Std. Error  t value      Pr(&gt;|t|)
## (Intercept)  3.2728356 0.12473523 26.23826 1.237371e-130
## extraversion 0.3458513 0.02324748 14.87694  1.481801e-47</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="multilevel-modelling-practical-2-week-3.html#cb58-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> simple.linear.model<span class="sc">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb58-2"><a href="multilevel-modelling-practical-2-week-3.html#cb58-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> simple.linear.model<span class="sc">$</span>coef[<span class="dv">2</span>]</span></code></pre></div>
<p>Plot the data and overlay the fitted regression line:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="multilevel-modelling-practical-2-week-3.html#cb59-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data  =</span> pop.data, <span class="fu">aes</span>(<span class="at">x =</span> extraversion, <span class="at">y =</span> popularity)) <span class="sc">+</span></span>
<span id="cb59-2"><a href="multilevel-modelling-practical-2-week-3.html#cb59-2" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.7</span>)<span class="sc">+</span> </span>
<span id="cb59-3"><a href="multilevel-modelling-practical-2-week-3.html#cb59-3" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="co"># to add regression line</span></span>
<span id="cb59-4"><a href="multilevel-modelling-practical-2-week-3.html#cb59-4" tabindex="-1"></a>                <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> .<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>Let’s produce a scatterplot with jitter, colour by class:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="multilevel-modelling-practical-2-week-3.html#cb61-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data  =</span> pop.data, <span class="fu">aes</span>(<span class="at">x =</span> extraversion, <span class="at">y =</span> popularity, <span class="at">col=</span>class)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="multilevel-modelling-practical-2-week-3.html#cb61-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="fl">0.8</span>) <span class="sc">+</span>  <span class="co"># to add some random noise for plotting purposes</span></span>
<span id="cb61-3"><a href="multilevel-modelling-practical-2-week-3.html#cb61-3" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">rainbow</span>(<span class="dv">100</span>)) <span class="co">#+</span></span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Does one line fit all? We now fit a separate model for each class. The models take the form (for each class <span class="math inline">\(j\)</span>)
<span class="math display">\[
y_{ij}=a_j+b_j x_{ij}+\epsilon_{ij}, \quad \epsilon_{ij}\sim N(0,\sigma^2_j).
\]</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="multilevel-modelling-practical-2-week-3.html#cb62-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pop.data, </span>
<span id="cb62-2"><a href="multilevel-modelling-practical-2-week-3.html#cb62-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> extraversion,<span class="at">y =</span> popularity, <span class="at">colour =</span> class, <span class="at">group =</span> class)</span>
<span id="cb62-3"><a href="multilevel-modelling-practical-2-week-3.html#cb62-3" tabindex="-1"></a>       ) <span class="sc">+</span> </span>
<span id="cb62-4"><a href="multilevel-modelling-practical-2-week-3.html#cb62-4" tabindex="-1"></a>     <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="multilevel-modelling-practical-2-week-3.html#cb62-5" tabindex="-1"></a>     <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">alpha  =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb62-6"><a href="multilevel-modelling-practical-2-week-3.html#cb62-6" tabindex="-1"></a>     <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">rainbow</span>(<span class="dv">100</span>))</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>We can extract the estimates of <span class="math inline">\(a_j\)</span> and <span class="math inline">\(b_j\)</span> via a <code>for</code> loop:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="multilevel-modelling-practical-2-week-3.html#cb63-1" tabindex="-1"></a>fit.all <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">100</span>,<span class="dv">2</span>) <span class="co">#one row for each class, cols are a and b</span></span>
<span id="cb63-2"><a href="multilevel-modelling-practical-2-week-3.html#cb63-2" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){  <span class="co">#loop over classes</span></span>
<span id="cb63-3"><a href="multilevel-modelling-practical-2-week-3.html#cb63-3" tabindex="-1"></a>  fit.all[j,]<span class="ot">&lt;-</span><span class="fu">lm</span>(popularity<span class="sc">~</span>extraversion, <span class="at">data=</span>pop.data, <span class="at">subset=</span>pop.data<span class="sc">$</span>class<span class="sc">==</span>j)<span class="sc">$</span>coef</span>
<span id="cb63-4"><a href="multilevel-modelling-practical-2-week-3.html#cb63-4" tabindex="-1"></a>}</span>
<span id="cb63-5"><a href="multilevel-modelling-practical-2-week-3.html#cb63-5" tabindex="-1"></a><span class="fu">colnames</span>(fit.all) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;slope&quot;</span>)</span>
<span id="cb63-6"><a href="multilevel-modelling-practical-2-week-3.html#cb63-6" tabindex="-1"></a>fit.all <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fit.all)</span></code></pre></div>
<p>Finally, plot histograms of the <span class="math inline">\(a_j\)</span> and <span class="math inline">\(b_j\)</span> estimates:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="multilevel-modelling-practical-2-week-3.html#cb64-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>fit.all, <span class="fu">aes</span>(intercept)) <span class="sc">+</span> </span>
<span id="cb64-2"><a href="multilevel-modelling-practical-2-week-3.html#cb64-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">15</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>a, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="multilevel-modelling-practical-2-week-3.html#cb65-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>fit.all, <span class="fu">aes</span>(slope)) <span class="sc">+</span> </span>
<span id="cb65-2"><a href="multilevel-modelling-practical-2-week-3.html#cb65-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">15</span>) <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>b, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-46-2.png" width="672" /></p>
<p><strong>TASK</strong> (harder): suppose that we model the intercepts via <span class="math inline">\(a_j = a +u_{j}\)</span> where <span class="math inline">\(u_j\sim N(0,\sigma^2_u)\)</span> independently of all other random variables. Write down the resulting model in the form <span class="math inline">\(y_{ij}= \ldots\)</span>. Is this likely to be a sensible model? What exploratory techniques can we use to answer his question? Discuss with colleagues and/or Andy.</p>
<p>For two pupils in the same class, what is the covariance between response values? What is the covariance between the response values of two pupils from different classes? How might we model the <span class="math inline">\(b_j\)</span>?</p>
<p>(Don’t worry if this looks a bit odd - we will unpack in next week’s lecture!)</p>
<p><span class="math inline">\(~\)</span></p>
</div>
</div>
<div id="exercise-2" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Exercise 2<a href="multilevel-modelling-practical-2-week-3.html#exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load the <code>mpg</code> data in the <code>ggplot2</code> package to obtain a data set on fuel efficiency.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="multilevel-modelling-practical-2-week-3.html#cb66-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mpg&quot;</span>, <span class="at">package =</span> <span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>Look at the help file to see the variables available (note: <code>?ggplot2::mpg</code>). You’ll need to map the plots requested below to the correct variable from the documentation.</p>
<ol style="list-style-type: decimal">
<li>Produce a scatter plot of the fuel efficiency on a highway (motorway, variable name <code>hwy</code>) against the engine’s size (aka displacement <code>displ</code>).</li>
</ol>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="multilevel-modelling-practical-2-week-3.html#cb67-1" tabindex="-1"></a><span class="co"># 1.</span></span>
<span id="cb67-2"><a href="multilevel-modelling-practical-2-week-3.html#cb67-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb67-3"><a href="multilevel-modelling-practical-2-week-3.html#cb67-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<img src="MLM_worksheets_files/figure-html/unnamed-chunk-48-1.png" width="672" />
</details>
<p><br></p>
<ul>
<li>There are a few vehicles with large engines that have unusually high fuel efficiency for such big engines. Colour the points by the type of car (the <code>class</code> variable). Can you explain these cars?</li>
</ul>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="multilevel-modelling-practical-2-week-3.html#cb68-1" tabindex="-1"></a><span class="co"># sub part 1</span></span>
<span id="cb68-2"><a href="multilevel-modelling-practical-2-week-3.html#cb68-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb68-3"><a href="multilevel-modelling-practical-2-week-3.html#cb68-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> class))</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
Notice that 5 of the 6 points have a large engine and higher than expected efficiency are 2-seater cars, so these are most likely sports cars which are lighter and despite having large engines use slightly less fuel.
</details>
<p><br></p>
<ul>
<li>Now remove the colouring but split the plot into facets where you have a graphic per car type. (Use <code>facet_wrap()</code> with <code>class</code>.)</li>
</ul>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="multilevel-modelling-practical-2-week-3.html#cb69-1" tabindex="-1"></a><span class="co"># sub part 2</span></span>
<span id="cb69-2"><a href="multilevel-modelling-practical-2-week-3.html#cb69-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb69-3"><a href="multilevel-modelling-practical-2-week-3.html#cb69-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> class) <span class="sc">+</span></span>
<span id="cb69-4"><a href="multilevel-modelling-practical-2-week-3.html#cb69-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<img src="MLM_worksheets_files/figure-html/unnamed-chunk-50-1.png" width="672" />
</details>
<p><br></p>
<ul>
<li>Add to this collection of plots the fuel efficiency for city driving, coloured in red. Update the y-axis to be called “Fuel efficiency” to reflect that it is not only the hwy variable plotted now.</li>
</ul>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="multilevel-modelling-practical-2-week-3.html#cb70-1" tabindex="-1"></a><span class="co"># sub part 3</span></span>
<span id="cb70-2"><a href="multilevel-modelling-practical-2-week-3.html#cb70-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb70-3"><a href="multilevel-modelling-practical-2-week-3.html#cb70-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> class) <span class="sc">+</span></span>
<span id="cb70-4"><a href="multilevel-modelling-practical-2-week-3.html#cb70-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-5"><a href="multilevel-modelling-practical-2-week-3.html#cb70-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cty), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb70-6"><a href="multilevel-modelling-practical-2-week-3.html#cb70-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Fuel efficiency&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
Note that we’re overriding the <code>y</code> mapping with the <code>cty</code>
variable, and putting the colour argument <em>outside</em> the aesthetic because it applies to all these points and is not data dependent.
</details>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li>Write the code to produce a scatterplot of highway fuel efficiency <code>hwy</code> against displacement <code>displ</code> coloured by drive type <code>drv</code> (front, rear, four). Overlay fitted regression lines coloured by drive type. Finally, overlay a single regression line, coloured black, based on all data.</li>
</ol>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="multilevel-modelling-practical-2-week-3.html#cb71-1" tabindex="-1"></a><span class="co"># 2. </span></span>
<span id="cb71-2"><a href="multilevel-modelling-practical-2-week-3.html#cb71-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb71-3"><a href="multilevel-modelling-practical-2-week-3.html#cb71-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> drv)) <span class="sc">+</span></span>
<span id="cb71-4"><a href="multilevel-modelling-practical-2-week-3.html#cb71-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> drv), <span class="at">method=</span>lm) <span class="sc">+</span></span>
<span id="cb71-5"><a href="multilevel-modelling-practical-2-week-3.html#cb71-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>When producing this plot we need to remember the rules <code>ggplot2</code> uses. We can’t put the colour in the <code>ggplot()</code> plot creation call, because then it will apply to all geoms (and we need the black smoother not to be split by drive train).</p>
Therefore, we put just <code>x</code> and <code>y</code> in the <code>ggplot()</code> call, add the points with the additional colour aesthetic, add a regression fit with the colour in an aesthetic so that we get a regression line per drive type, then add the black regression line with the colour not specified as an aesthetic because it applies to all the data (instead, just a direct argument).
</details>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li>Produce a bar plot of the count of the number of each type of vehicle (<code>class</code>) in the data by using the Geom <code>geom_bar()</code>, with aesthetic <code>x</code> set to the vehicle type (NB: this question is to help you check if you are starting to understand the plotting system, because even though we didn’t show an example of a bar plot, this sentence alone should be enough information without needing to look at the documentation. The plotting system follows a coherent set of rules for all plot types!)</li>
</ol>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="multilevel-modelling-practical-2-week-3.html#cb72-1" tabindex="-1"></a><span class="co"># 3.</span></span>
<span id="cb72-2"><a href="multilevel-modelling-practical-2-week-3.html#cb72-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="multilevel-modelling-practical-2-week-3.html#cb72-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<img src="MLM_worksheets_files/figure-html/unnamed-chunk-53-1.png" width="672" />
</details>
<p><br></p>
<ul>
<li>Make a second version where you also add an aesthetic <code>fill</code> which is set to the variable <code>drv</code>. What is this showing?</li>
</ul>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="multilevel-modelling-practical-2-week-3.html#cb73-1" tabindex="-1"></a><span class="co"># 3. sub part</span></span>
<span id="cb73-2"><a href="multilevel-modelling-practical-2-week-3.html#cb73-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill =</span> drv)) <span class="sc">+</span></span>
<span id="cb73-3"><a href="multilevel-modelling-practical-2-week-3.html#cb73-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
Each bar is still the same height as in the first bar plot, but now it is broken down to show how many of each type of car is 4-wheel, front wheel and rear wheel drive.
</details>
<p><br></p>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="exercise-3-if-time" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Exercise 3 (if time)<a href="multilevel-modelling-practical-2-week-3.html#exercise-3-if-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The data used here represent Maths achievement scores of a subsample of subjects from the 1982 High School and Beyond Survey. The full dataset can be found within the package <a href="https://rdrr.io/cran/merTools/man/hsb.html">merTools</a>. Click the link to read about the data set.</p>
<p>The analysis starts by introducing the data and producing some visual representations.</p>
<p>Read in the data from Andy’s Github page with</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="multilevel-modelling-practical-2-week-3.html#cb74-1" tabindex="-1"></a>sub_hsb <span class="ot">&lt;-</span> </span>
<span id="cb74-2"><a href="multilevel-modelling-practical-2-week-3.html#cb74-2" tabindex="-1"></a>   <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;https://andygolightly.github.io/teaching/MATH43515/sub_hsb.csv&quot;</span>)</span></code></pre></div>
<p>Carry out the following operations for simple access of variables.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="multilevel-modelling-practical-2-week-3.html#cb75-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> sub_hsb</span>
<span id="cb75-2"><a href="multilevel-modelling-practical-2-week-3.html#cb75-2" tabindex="-1"></a>mathach <span class="ot">&lt;-</span> data<span class="sc">$</span>mathach <span class="co"># Maths achievement score (response)</span></span>
<span id="cb75-3"><a href="multilevel-modelling-practical-2-week-3.html#cb75-3" tabindex="-1"></a>ses <span class="ot">&lt;-</span> data<span class="sc">$</span>ses</span>
<span id="cb75-4"><a href="multilevel-modelling-practical-2-week-3.html#cb75-4" tabindex="-1"></a>female <span class="ot">&lt;-</span> data<span class="sc">$</span>female</span>
<span id="cb75-5"><a href="multilevel-modelling-practical-2-week-3.html#cb75-5" tabindex="-1"></a>school.f <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>schid)</span></code></pre></div>
<p>Data inspection:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="multilevel-modelling-practical-2-week-3.html#cb76-1" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##   schid minority female    ses mathach size schtype meanses
## 1  1224        0      1 -1.528   5.876  842       0  -0.428
## 2  1224        0      1 -0.588  19.708  842       0  -0.428
## 3  1224        0      0 -0.528  20.349  842       0  -0.428
## 4  1224        0      0 -0.668   8.781  842       0  -0.428
## 5  1224        0      0 -0.158  17.898  842       0  -0.428
## 6  1224        0      0  0.022   4.583  842       0  -0.428</code></pre>
<p>Start with a linear regression as a baseline model.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="multilevel-modelling-practical-2-week-3.html#cb78-1" tabindex="-1"></a>lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(mathach<span class="sc">~</span>ses, <span class="at">data=</span>data)</span>
<span id="cb78-2"><a href="multilevel-modelling-practical-2-week-3.html#cb78-2" tabindex="-1"></a></span>
<span id="cb78-3"><a href="multilevel-modelling-practical-2-week-3.html#cb78-3" tabindex="-1"></a><span class="fu">summary</span>(lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mathach ~ ses, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -18.0019  -4.6006   0.0497   5.2174  16.0877 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  12.8864     0.1753   73.51   &lt;2e-16 ***
## ses           3.4530     0.2222   15.54   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.39 on 1327 degrees of freedom
## Multiple R-squared:  0.1539, Adjusted R-squared:  0.1533 
## F-statistic: 241.5 on 1 and 1327 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Visualise the linear relationship.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="multilevel-modelling-practical-2-week-3.html#cb80-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data  =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> ses, <span class="at">y =</span> mathach))<span class="sc">+</span></span>
<span id="cb80-2"><a href="multilevel-modelling-practical-2-week-3.html#cb80-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> .<span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb80-3"><a href="multilevel-modelling-practical-2-week-3.html#cb80-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">&quot;Red&quot;</span>)<span class="sc">+</span></span>
<span id="cb80-4"><a href="multilevel-modelling-practical-2-week-3.html#cb80-4" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mathach vs. Ses&quot;</span>) <span class="sc">+</span></span>
<span id="cb80-5"><a href="multilevel-modelling-practical-2-week-3.html#cb80-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Ses&quot;</span>) <span class="sc">+</span> </span>
<span id="cb80-6"><a href="multilevel-modelling-practical-2-week-3.html#cb80-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mathach&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>Carry out further exploratory analysis of the data along the lines of the previous example.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="multilevel-modelling-practical-2-week-3.html#cb81-1" tabindex="-1"></a><span class="co"># ...</span></span></code></pre></div>
<p><br></p>
<p>End of lab!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multilevel-modelling-practical-1-week-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multilevel-modelling-practical-3-week-4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"sidebar": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
