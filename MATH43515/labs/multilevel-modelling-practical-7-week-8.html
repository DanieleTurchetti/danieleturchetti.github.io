<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Multilevel Modelling Practical 7 (Week 8) | MLM_worksheets.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Multilevel Modelling Practical 7 (Week 8) | MLM_worksheets.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Multilevel Modelling Practical 7 (Week 8) | MLM_worksheets.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multilevel-modelling-practical-6-week-7.html"/>
<link rel="next" href="multilevel-modelling-practical-8-week-9.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Home</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to multilevel modelling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#including-plots"><i class="fa fa-check"></i><b>1.1</b> Including Plots</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multilevel-modelling-practical-1-week-2.html"><a href="multilevel-modelling-practical-1-week-2.html"><i class="fa fa-check"></i><b>2</b> Multilevel Modelling Practical 1 (Week 2)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="multilevel-modelling-practical-1-week-2.html"><a href="multilevel-modelling-practical-1-week-2.html#instructions-start-here"><i class="fa fa-check"></i><b>2.1</b> Instructions – start here!</a></li>
<li class="chapter" data-level="2.2" data-path="multilevel-modelling-practical-1-week-2.html"><a href="multilevel-modelling-practical-1-week-2.html#exercises-1"><i class="fa fa-check"></i><b>2.2</b> Exercises 1</a></li>
<li class="chapter" data-level="2.3" data-path="multilevel-modelling-practical-1-week-2.html"><a href="multilevel-modelling-practical-1-week-2.html#exercises-2"><i class="fa fa-check"></i><b>2.3</b> Exercises 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html"><i class="fa fa-check"></i><b>3</b> Multilevel Modelling Practical 2 (Week 3)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#instructions-start-here-1"><i class="fa fa-check"></i><b>3.1</b> Instructions – start here!</a></li>
<li class="chapter" data-level="3.2" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#exercises-1-1"><i class="fa fa-check"></i><b>3.2</b> Exercises 1</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#acquire-and-prepare-data"><i class="fa fa-check"></i><b>3.2.1</b> Acquire and prepare data</a></li>
<li class="chapter" data-level="3.2.2" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#exploratory-analysis"><i class="fa fa-check"></i><b>3.2.2</b> Exploratory analysis</a></li>
<li class="chapter" data-level="3.2.3" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#naive-simple-linear-regression-models"><i class="fa fa-check"></i><b>3.2.3</b> Naive simple linear regression models</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#exercise-2"><i class="fa fa-check"></i><b>3.3</b> Exercise 2</a></li>
<li class="chapter" data-level="3.4" data-path="multilevel-modelling-practical-2-week-3.html"><a href="multilevel-modelling-practical-2-week-3.html#exercise-3-if-time"><i class="fa fa-check"></i><b>3.4</b> Exercise 3 (if time)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html"><i class="fa fa-check"></i><b>4</b> Multilevel Modelling Practical 3 (Week 4)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#instructions-start-here-2"><i class="fa fa-check"></i><b>4.1</b> Instructions – start here!</a></li>
<li class="chapter" data-level="4.2" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#exercise-1"><i class="fa fa-check"></i><b>4.2</b> Exercise 1</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#preparation-of-the-data-set"><i class="fa fa-check"></i><b>4.2.1</b> Preparation of the data set</a></li>
<li class="chapter" data-level="4.2.2" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#fitting-the-random-intercept-and-slope-model"><i class="fa fa-check"></i><b>4.2.2</b> Fitting the random intercept and slope model</a></li>
<li class="chapter" data-level="4.2.3" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#fitted-lines-by-class"><i class="fa fa-check"></i><b>4.2.3</b> Fitted lines by class</a></li>
<li class="chapter" data-level="4.2.4" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#the-intercept-only-empty-model-and-icc"><i class="fa fa-check"></i><b>4.2.4</b> The intercept-only / empty model and ICC</a></li>
<li class="chapter" data-level="4.2.5" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#the-random-intercept-model-with-covariate"><i class="fa fa-check"></i><b>4.2.5</b> The random intercept model (with covariate)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#exercise-2-1"><i class="fa fa-check"></i><b>4.3</b> Exercise 2</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#preparation"><i class="fa fa-check"></i><b>4.3.1</b> Preparation</a></li>
<li class="chapter" data-level="4.3.2" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#the-random-intercept-model"><i class="fa fa-check"></i><b>4.3.2</b> The random intercept model</a></li>
<li class="chapter" data-level="4.3.3" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#diagnostics"><i class="fa fa-check"></i><b>4.3.3</b> Diagnostics</a></li>
<li class="chapter" data-level="4.3.4" data-path="multilevel-modelling-practical-3-week-4.html"><a href="multilevel-modelling-practical-3-week-4.html#include-a-second-fixed-effect-variable-gender"><i class="fa fa-check"></i><b>4.3.4</b> Include a second fixed effect variable: gender</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html"><i class="fa fa-check"></i><b>5</b> Multilevel Modelling Practical 4 (Week 5)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#instructions-start-here-3"><i class="fa fa-check"></i><b>5.1</b> Instructions – start here!</a></li>
<li class="chapter" data-level="5.2" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#exercise-1-analysis-of-the-active-time-study-data-lecture-5"><i class="fa fa-check"></i><b>5.2</b> Exercise 1: Analysis of the Active Time study data (lecture 5)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#how-important-is-group-structure-vpcs-and-iccs"><i class="fa fa-check"></i><b>5.2.1</b> How important is group structure? (VPCs and ICCs)</a></li>
<li class="chapter" data-level="5.2.2" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#three-level-model-with-explanatory-variables"><i class="fa fa-check"></i><b>5.2.2</b> Three level Model with explanatory variables</a></li>
<li class="chapter" data-level="5.2.3" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#comparison-of-empty-model-with-model-with-explanatory-variables"><i class="fa fa-check"></i><b>5.2.3</b> Comparison of empty model with model with explanatory variables</a></li>
<li class="chapter" data-level="5.2.4" data-path="multilevel-modelling-practical-4-week-5.html"><a href="multilevel-modelling-practical-4-week-5.html#further-analysis-bottom-up-approach"><i class="fa fa-check"></i><b>5.2.4</b> Further analysis (bottom up approach)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multilevel-modelling-practical-5-week-6.html"><a href="multilevel-modelling-practical-5-week-6.html"><i class="fa fa-check"></i><b>6</b> Multilevel Modelling Practical 5 (Week 6)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multilevel-modelling-practical-5-week-6.html"><a href="multilevel-modelling-practical-5-week-6.html#instructions---start-here"><i class="fa fa-check"></i><b>6.1</b> Instructions - start here!</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="multilevel-modelling-practical-5-week-6.html"><a href="multilevel-modelling-practical-5-week-6.html#overview"><i class="fa fa-check"></i><b>6.1.1</b> Overview</a></li>
<li class="chapter" data-level="6.1.2" data-path="multilevel-modelling-practical-5-week-6.html"><a href="multilevel-modelling-practical-5-week-6.html#multilevel-modelling-with-longitudinal-data"><i class="fa fa-check"></i><b>6.1.2</b> Multilevel modelling with longitudinal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html"><i class="fa fa-check"></i><b>7</b> Multilevel Modelling Practical 6 (Week 7)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#instructions---start-here-1"><i class="fa fa-check"></i><b>7.1</b> Instructions - start here!</a></li>
<li class="chapter" data-level="7.2" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#exercise-1-long-and-wide-data-shape"><i class="fa fa-check"></i><b>7.2</b> Exercise 1 (Long and wide data shape)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#regression-vs-multilevel-analysis"><i class="fa fa-check"></i><b>7.2.1</b> Regression vs multilevel analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#exercise-2-simulation-from-the-two-level-longitudinal-model"><i class="fa fa-check"></i><b>7.3</b> Exercise 2 (simulation from the two-level longitudinal model)</a></li>
<li class="chapter" data-level="7.4" data-path="multilevel-modelling-practical-6-week-7.html"><a href="multilevel-modelling-practical-6-week-7.html#end-of-lab"><i class="fa fa-check"></i><b>7.4</b> End of lab!</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html"><i class="fa fa-check"></i><b>8</b> Multilevel Modelling Practical 7 (Week 8)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#instructions---start-here-2"><i class="fa fa-check"></i><b>8.1</b> Instructions - start here!</a></li>
<li class="chapter" data-level="8.2" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#exercise-1-aids-data-example-2-from-lecture-7"><i class="fa fa-check"></i><b>8.2</b> Exercise 1 (Aids data: Example 2 from lecture 7)</a></li>
<li class="chapter" data-level="8.3" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#exercise-2-leukaemia-data-example-3-from-lecture-7"><i class="fa fa-check"></i><b>8.3</b> Exercise 2 (Leukaemia data: Example 3 from lecture 7)</a></li>
<li class="chapter" data-level="8.4" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#exercise-3-toxoplasmosis-data-binomial-logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Exercise 3: Toxoplasmosis data (Binomial logistic regression)</a></li>
<li class="chapter" data-level="8.5" data-path="multilevel-modelling-practical-7-week-8.html"><a href="multilevel-modelling-practical-7-week-8.html#end-of-lab-1"><i class="fa fa-check"></i><b>8.5</b> ## End of lab!</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html"><i class="fa fa-check"></i><b>9</b> Multilevel Modelling Practical 8 (Week 9)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#instructions---start-here-3"><i class="fa fa-check"></i><b>9.1</b> Instructions - start here!</a></li>
<li class="chapter" data-level="9.2" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#preliminaries"><i class="fa fa-check"></i><b>9.2</b> Preliminaries</a></li>
<li class="chapter" data-level="9.3" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#exercise-1-betablocker-data"><i class="fa fa-check"></i><b>9.3</b> Exercise 1: Betablocker data</a></li>
<li class="chapter" data-level="9.4" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#exercise-2-digging-deeper"><i class="fa fa-check"></i><b>9.4</b> Exercise 2 (digging deeper)</a></li>
<li class="chapter" data-level="9.5" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#exercise-3-optional-toxoplasmosis-data-revisited"><i class="fa fa-check"></i><b>9.5</b> Exercise 3 (optional): Toxoplasmosis data revisited</a></li>
<li class="chapter" data-level="9.6" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#summative-assessment"><i class="fa fa-check"></i><b>9.6</b> Summative assessment</a></li>
<li class="chapter" data-level="9.7" data-path="multilevel-modelling-practical-8-week-9.html"><a href="multilevel-modelling-practical-8-week-9.html#end-of-lab-2"><i class="fa fa-check"></i><b>9.7</b> ## End of lab!</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multilevel-modelling-practical-9-week-10.html"><a href="multilevel-modelling-practical-9-week-10.html"><i class="fa fa-check"></i><b>10</b> Multilevel Modelling Practical 9 (Week 10)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multilevel-modelling-practical-9-week-10.html"><a href="multilevel-modelling-practical-9-week-10.html#dealing-with-missing-values"><i class="fa fa-check"></i><b>10.1</b> Dealing with missing values</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multilevel-modelling-practical-7-week-8" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Multilevel Modelling Practical 7 (Week 8)<a href="multilevel-modelling-practical-7-week-8.html#multilevel-modelling-practical-7-week-8" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="instructions---start-here-2" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Instructions - start here!<a href="multilevel-modelling-practical-7-week-8.html#instructions---start-here-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Exercise 1</strong> involves the analysis of the data set used in Example 2 of the week 7 lecture. <strong>Exercise 2</strong> considers the data set on survival times from Example 3. <strong>Exercise 3</strong> involves a logistic regression model for Binomial data.</p>
</div>
<div id="exercise-1-aids-data-example-2-from-lecture-7" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Exercise 1 (Aids data: Example 2 from lecture 7)<a href="multilevel-modelling-practical-7-week-8.html#exercise-1-aids-data-example-2-from-lecture-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Read in and visualize the data:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="multilevel-modelling-practical-7-week-8.html#cb223-1" tabindex="-1"></a>aids <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://andygolightly.github.io/teaching/MATH43515/aids.asc&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb223-2"><a href="multilevel-modelling-practical-7-week-8.html#cb223-2" tabindex="-1"></a><span class="fu">plot</span>(aids, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-146-1.png" width="672" /></p>
<p>Let’s first ignore the fact that the data are counts and fit a simple linear regression model of the form</p>
<p><span class="math display">\[y_i = \beta_0 +\beta_1 x_i + \epsilon_{i},\quad i=1,\ldots,14\]</span>
where <span class="math inline">\(x_i\)</span> denotes the <span class="math inline">\(i\)</span>th time point.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="multilevel-modelling-practical-7-week-8.html#cb224-1" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(deaths<span class="sc">~</span>time, <span class="at">data=</span>aids)</span>
<span id="cb224-2"><a href="multilevel-modelling-practical-7-week-8.html#cb224-2" tabindex="-1"></a><span class="fu">plot</span>(aids, <span class="at">type=</span><span class="st">&quot;h&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">50</span>))</span>
<span id="cb224-3"><a href="multilevel-modelling-practical-7-week-8.html#cb224-3" tabindex="-1"></a><span class="fu">lines</span>(aids<span class="sc">$</span>time, <span class="fu">predict</span>(lm1))</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
<p>There are multiple issues here, in addition to ignoring the discrete nature of the response variable.</p>
<p><span class="math inline">\(~\)</span></p>
<p>Let’s use the Poisson distribution to model the response. Recall that if <span class="math inline">\(Y\sim Po(\lambda)\)</span> then <span class="math inline">\(Y\)</span> takes values <span class="math inline">\(0,1,\ldots,\)</span> with probabilities</p>
<p><span class="math display">\[f(y)=\frac{e^{-\lambda}\lambda^y}{y!}=\exp\{y\log (\lambda)-\lambda-\log(y!)\}\]</span>
with the latter in exponential family form. The mean of <span class="math inline">\(Y\)</span> is <span class="math inline">\(\lambda\)</span>. We can check this via simulation:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="multilevel-modelling-practical-7-week-8.html#cb225-1" tabindex="-1"></a>ypois <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">10000</span>,<span class="at">lambda=</span><span class="dv">2</span>) <span class="co">#simulate Po(2) realisations</span></span>
<span id="cb225-2"><a href="multilevel-modelling-practical-7-week-8.html#cb225-2" tabindex="-1"></a><span class="fu">mean</span>(ypois)</span></code></pre></div>
<pre><code>## [1] 1.9981</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="multilevel-modelling-practical-7-week-8.html#cb227-1" tabindex="-1"></a><span class="fu">var</span>(ypois)</span></code></pre></div>
<pre><code>## [1] 1.964893</code></pre>
<p>(It turns out that the variance is also <span class="math inline">\(\lambda\)</span>. Try changing <span class="math inline">\(\lambda\)</span> and the number of simulations.)</p>
<p>Now, we can identify the natural link function as <span class="math inline">\(\log(\cdot)\)</span>. Hence, we will fit a GLM with <span class="math inline">\(\log(\lambda_i)=\beta_0+\beta_1 x_i\)</span>.</p>
<p>Fit a Poisson GLM and display the model summary:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="multilevel-modelling-practical-7-week-8.html#cb229-1" tabindex="-1"></a>glm1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(deaths<span class="sc">~</span>time, <span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span>log), <span class="at">data=</span>aids)</span>
<span id="cb229-2"><a href="multilevel-modelling-practical-7-week-8.html#cb229-2" tabindex="-1"></a><span class="fu">summary</span>(glm1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deaths ~ time, family = poisson(link = log), data = aids)
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.33963    0.25119   1.352    0.176    
## time         0.25652    0.02204  11.639   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 207.272  on 13  degrees of freedom
## Residual deviance:  29.654  on 12  degrees of freedom
## AIC: 86.581
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Add the fitted curve (expected number of aids cases as a function of time) to the plot with:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="multilevel-modelling-practical-7-week-8.html#cb231-1" tabindex="-1"></a><span class="fu">plot</span>(aids, <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb231-2"><a href="multilevel-modelling-practical-7-week-8.html#cb231-2" tabindex="-1"></a><span class="fu">lines</span>(aids<span class="sc">$</span>time, <span class="fu">predict</span>(glm1, <span class="at">type=</span><span class="st">&quot;response&quot;</span>))</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<p><strong>TASK:</strong> Reproduce this plot using <code>ggplot</code>. Hint: this will require <code>geom_segment()</code>.</p>
<details>
<summary>
Click for solution
</summary>
<p>Reproduce the plot in ggplot:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="multilevel-modelling-practical-7-week-8.html#cb232-1" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb232-2"><a href="multilevel-modelling-practical-7-week-8.html#cb232-2" tabindex="-1"></a>aids<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm1,<span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb232-3"><a href="multilevel-modelling-practical-7-week-8.html#cb232-3" tabindex="-1"></a><span class="fu">ggplot</span>(aids,<span class="fu">aes</span>(<span class="at">x=</span>time,<span class="at">xend=</span>time,<span class="at">y=</span><span class="dv">0</span>,<span class="at">yend=</span>deaths))<span class="sc">+</span></span>
<span id="cb232-4"><a href="multilevel-modelling-practical-7-week-8.html#cb232-4" tabindex="-1"></a>  <span class="fu">geom_segment</span>()<span class="sc">+</span></span>
<span id="cb232-5"><a href="multilevel-modelling-practical-7-week-8.html#cb232-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>time,<span class="at">y=</span>pred))<span class="sc">+</span></span>
<span id="cb232-6"><a href="multilevel-modelling-practical-7-week-8.html#cb232-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;time&quot;</span>)<span class="sc">+</span></span>
<span id="cb232-7"><a href="multilevel-modelling-practical-7-week-8.html#cb232-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;deaths&quot;</span>)</span></code></pre></div>
<img src="MLM_worksheets_files/figure-html/unnamed-chunk-151-1.png" width="672" />
</details>
<p><span class="math inline">\(~\)</span></p>
<p><strong>TASK:</strong> What would be the predicted number of deaths in month 15?</p>
<p>There are three ways of answering this question:</p>
<ul>
<li>Manually, by implementing <span class="math inline">\(\exp(\hat{\beta}_0+\hat{\beta}_1\times 15)\)</span>;</li>
<li>Using function <code>predict</code> to obtain <span class="math inline">\(\hat{\beta}_0+\hat{\beta}_1\times 15\)</span>, but still exponentiating the output;</li>
<li>Using function <code>predict</code> with option <code>type="response"</code>, also avoiding the manual transformation.</li>
</ul>
<p>Try at least two of these and make sure that results match!</p>
<details>
<summary>
Click for solution
</summary>
<p>Calculate the predicted number of deaths in month 15:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="multilevel-modelling-practical-7-week-8.html#cb233-1" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">predict</span>(glm1, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">time=</span><span class="dv">15</span>)))</span></code></pre></div>
<pre><code>##        1 
## 65.85714</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="multilevel-modelling-practical-7-week-8.html#cb235-1" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb235-2"><a href="multilevel-modelling-practical-7-week-8.html#cb235-2" tabindex="-1"></a><span class="fu">predict</span>(glm1, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">time=</span><span class="dv">15</span>), <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##        1 
## 65.85714</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="multilevel-modelling-practical-7-week-8.html#cb237-1" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb237-2"><a href="multilevel-modelling-practical-7-week-8.html#cb237-2" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">0.3396+0.2565</span><span class="sc">*</span><span class="dv">15</span>)</span></code></pre></div>
<pre><code>## [1] 65.8316</code></pre>
</details>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="exercise-2-leukaemia-data-example-3-from-lecture-7" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Exercise 2 (Leukaemia data: Example 3 from lecture 7)<a href="multilevel-modelling-practical-7-week-8.html#exercise-2-leukaemia-data-example-3-from-lecture-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Read in and display the data</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="multilevel-modelling-practical-7-week-8.html#cb239-1" tabindex="-1"></a>leu <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://andygolightly.github.io/teaching/MATH43515/leukaemie.asc&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb239-2"><a href="multilevel-modelling-practical-7-week-8.html#cb239-2" tabindex="-1"></a></span>
<span id="cb239-3"><a href="multilevel-modelling-practical-7-week-8.html#cb239-3" tabindex="-1"></a><span class="fu">plot</span>(leu, <span class="at">xlab=</span><span class="st">&quot;log(# white blood cells)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;survival time&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<p>Let’s fit a simple linear regression model of the form</p>
<p><span class="math display">\[y_i = \beta_0 +\beta_1 x_i + \epsilon_{i},\quad i=1,\ldots,14\]</span>
where <span class="math inline">\(y_i\)</span> denotes survival time and <span class="math inline">\(x_i\)</span> denotes the <span class="math inline">\(i\)</span>th <span class="math inline">\(\log_{10}\)</span> white blood cell count.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="multilevel-modelling-practical-7-week-8.html#cb240-1" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(time<span class="sc">~</span>wbc, <span class="at">data=</span>leu)</span>
<span id="cb240-2"><a href="multilevel-modelling-practical-7-week-8.html#cb240-2" tabindex="-1"></a><span class="fu">plot</span>(leu, <span class="at">xlab=</span><span class="st">&quot;log(# white blood cells)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;survival time&quot;</span>)</span>
<span id="cb240-3"><a href="multilevel-modelling-practical-7-week-8.html#cb240-3" tabindex="-1"></a><span class="fu">lines</span>(leu<span class="sc">$</span>wbc, <span class="fu">predict</span>(lm2))</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
<p>The model will predict a negative survival time for a <span class="math inline">\(\log_{10}\)</span> white blood cell count greater than around 5.15. We could fit a model of the form</p>
<p><span class="math display">\[\log y_i = \beta_0 +\beta_1 x_i + \epsilon_{i},\quad i=1,\ldots,14\]</span>
which would circumvent this issue. (In fact, this would be assuming a lognormal model for the response.) However, plotting the log response against the covariate gives:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="multilevel-modelling-practical-7-week-8.html#cb241-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(leu), <span class="at">xlab=</span><span class="st">&quot;log(# white blood cells)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;log survival time&quot;</span>)</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-155-1.png" width="672" /></p>
<p>for which there is some suggestion of heteroscedasticity of errors about a hypothetical straight line fit.</p>
<p><span class="math inline">\(~\)</span></p>
<p>We will instead model the expected response with a Gamma distribution.</p>
<p>Use the following illustrative code to visualize the density function of the Gamma distribution for shape parameters 1, 2, 3, 4 and 5 (and use this to make clear to yourself why this distribution is useful for modelling waiting times).</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="multilevel-modelling-practical-7-week-8.html#cb242-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb242-2"><a href="multilevel-modelling-practical-7-week-8.html#cb242-2" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb242-3"><a href="multilevel-modelling-practical-7-week-8.html#cb242-3" tabindex="-1"></a>rate  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb242-4"><a href="multilevel-modelling-practical-7-week-8.html#cb242-4" tabindex="-1"></a></span>
<span id="cb242-5"><a href="multilevel-modelling-practical-7-week-8.html#cb242-5" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="fu">dgamma</span>(y, shape[<span class="dv">1</span>], rate[<span class="dv">1</span>]), <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;y&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;f(y)&quot;</span>)</span>
<span id="cb242-6"><a href="multilevel-modelling-practical-7-week-8.html#cb242-6" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb242-7"><a href="multilevel-modelling-practical-7-week-8.html#cb242-7" tabindex="-1"></a>  {</span>
<span id="cb242-8"><a href="multilevel-modelling-practical-7-week-8.html#cb242-8" tabindex="-1"></a>   <span class="fu">lines</span>(y, <span class="fu">dgamma</span>(y, shape[j], rate[j]), <span class="at">col=</span>j)</span>
<span id="cb242-9"><a href="multilevel-modelling-practical-7-week-8.html#cb242-9" tabindex="-1"></a>  }</span></code></pre></div>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<p>If <span class="math inline">\(Y\sim \text{Gamma}(a,b)\)</span> for shape and rate parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, the mean (expectation) of <span class="math inline">\(Y\)</span> is <span class="math inline">\(\mu=a/b\)</span>. Let’s consider a GLM with a log link function so that <span class="math inline">\(\log(\mu_i) = \beta_0+\beta_1 x_i\)</span> where <span class="math inline">\(x_i\)</span> is the <span class="math inline">\(i\)</span>th value of <span class="math inline">\(\log_{10}\)</span> white blood cell count.</p>
<p><strong>TASK:</strong> Fit a generalized linear model with <code>time</code> as response, and <code>wbc</code> as predictor. Use a <code>Gamma</code> response distribution and a log link. Save the model as <code>glm2</code>.</p>
<details>
<summary>
Click for solution
</summary>
<p>Fit a generalized linear model with <code>time</code> as response, and <code>wbc</code> as predictor. Use a <code>Gamma</code> response distribution and a log link:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="multilevel-modelling-practical-7-week-8.html#cb243-1" tabindex="-1"></a>glm2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(time <span class="sc">~</span> wbc, <span class="at">family=</span><span class="fu">Gamma</span>(<span class="at">link=</span>log), <span class="at">data=</span>leu)</span>
<span id="cb243-2"><a href="multilevel-modelling-practical-7-week-8.html#cb243-2" tabindex="-1"></a><span class="fu">summary</span>(glm2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = time ~ wbc, family = Gamma(link = log), data = leu)
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   8.4775     1.6034   5.287 9.13e-05 ***
## wbc          -1.1093     0.3872  -2.865   0.0118 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.9388638)
## 
##     Null deviance: 26.282  on 16  degrees of freedom
## Residual deviance: 19.457  on 15  degrees of freedom
## AIC: 173.97
## 
## Number of Fisher Scoring iterations: 8</code></pre>
</details>
<p><span class="math inline">\(~\)</span></p>
<p>Now plot the fitted response as a function of <code>wbc</code> by running the following code:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="multilevel-modelling-practical-7-week-8.html#cb245-1" tabindex="-1"></a><span class="fu">plot</span>(leu, <span class="at">xlab=</span><span class="st">&quot;log(number of white blood cells)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;survival time&quot;</span>)</span>
<span id="cb245-2"><a href="multilevel-modelling-practical-7-week-8.html#cb245-2" tabindex="-1"></a><span class="fu">lines</span>(leu<span class="sc">$</span>wbc[<span class="fu">order</span>(leu<span class="sc">$</span>wbc)], <span class="fu">predict</span>(glm2, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)[<span class="fu">order</span>(leu<span class="sc">$</span>wbc)])</span></code></pre></div>
<p><strong>TASK:</strong> In the above, why is the use of <code>order</code> necessary?</p>
<details>
<summary>
Click for solution
</summary>
<p><img src="MLM_worksheets_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
Note that the <code>lines</code> function will draw <em>straight lines</em> between x values specified by <code>wbc</code> and y values specified by the corresponding prediction. Without ordering <code>wbc</code> (and the corresponding predictions accordingly), the resulting plot will look rather strange! Try it out!
</details>
<p><span class="math inline">\(~\)</span></p>
<p><strong>TASK:</strong> recreate the above plot using <code>ggplot</code>.</p>
<details>
<summary>
Click for solution
</summary>
<p>Using <code>ggplot</code>:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="multilevel-modelling-practical-7-week-8.html#cb246-1" tabindex="-1"></a>leu<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm2,<span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb246-2"><a href="multilevel-modelling-practical-7-week-8.html#cb246-2" tabindex="-1"></a><span class="fu">ggplot</span>(leu,<span class="fu">aes</span>(<span class="at">x=</span>wbc,<span class="at">y=</span>time))<span class="sc">+</span></span>
<span id="cb246-3"><a href="multilevel-modelling-practical-7-week-8.html#cb246-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb246-4"><a href="multilevel-modelling-practical-7-week-8.html#cb246-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>wbc[<span class="fu">order</span>(wbc)],<span class="at">y=</span>pred[<span class="fu">order</span>(wbc)]))<span class="sc">+</span></span>
<span id="cb246-5"><a href="multilevel-modelling-practical-7-week-8.html#cb246-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;log(number of white blood cells)&quot;</span>)<span class="sc">+</span></span>
<span id="cb246-6"><a href="multilevel-modelling-practical-7-week-8.html#cb246-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;survival time&quot;</span>)</span></code></pre></div>
<img src="MLM_worksheets_files/figure-html/unnamed-chunk-160-1.png" width="672" />
</details>
<p><span class="math inline">\(~\)</span></p>
<p><strong>TASK:</strong> Predict the survival time for a white blood cell count of 160.</p>
<details>
<summary>
Click for solution
</summary>
<p>Predict the survival time for a white blood cell count of 160:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="multilevel-modelling-practical-7-week-8.html#cb247-1" tabindex="-1"></a><span class="fu">predict</span>(glm2,<span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">wbc=</span><span class="fu">log10</span>(<span class="dv">160</span>)), <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##        1 
## 416.7432</code></pre>
</details>
<p><span class="math inline">\(~\)</span></p>
<p><strong>HARDER:</strong> What does the following code do? (assuming that <code>glm3</code> contains the fitted model). After spending some time thinking about this, uncover the solution for a bonus plot.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="multilevel-modelling-practical-7-week-8.html#cb249-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm2,<span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">wbc=</span><span class="fu">log10</span>(<span class="dv">160</span>)), <span class="at">type=</span><span class="st">&quot;link&quot;</span>,<span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb249-2"><a href="multilevel-modelling-practical-7-week-8.html#cb249-2" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">exp</span>(out<span class="sc">$</span>fit<span class="dv">-2</span><span class="sc">*</span>out<span class="sc">$</span>se.fit),<span class="fu">exp</span>(out<span class="sc">$</span>fit<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>out<span class="sc">$</span>se.fit))</span></code></pre></div>
<details>
<summary>
Click for solution
</summary>
<p>The following code produces an approximate 95% confidence interval for the expected survival time given a white blood cell count of 160.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="multilevel-modelling-practical-7-week-8.html#cb250-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm2,<span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">wbc=</span><span class="fu">log10</span>(<span class="dv">160</span>)), <span class="at">type=</span><span class="st">&quot;link&quot;</span>,<span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb250-2"><a href="multilevel-modelling-practical-7-week-8.html#cb250-2" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">exp</span>(out<span class="sc">$</span>fit<span class="dv">-2</span><span class="sc">*</span>out<span class="sc">$</span>se.fit),<span class="fu">exp</span>(out<span class="sc">$</span>fit<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>out<span class="sc">$</span>se.fit))</span></code></pre></div>
<pre><code>##          1          1 
##   89.45865 1941.39827</code></pre>
<p>Note that we first find an interval for the <em>linear predictor</em> and then run this through the <em>response function</em> (which is the <code>exp</code> function for this example).</p>
<p><strong>Bonus</strong> - overlay a 95% confidence interval:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="multilevel-modelling-practical-7-week-8.html#cb252-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm2, <span class="at">type=</span><span class="st">&quot;link&quot;</span>,<span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb252-2"><a href="multilevel-modelling-practical-7-week-8.html#cb252-2" tabindex="-1"></a>leu<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">exp</span>(out<span class="sc">$</span>fit<span class="dv">-2</span><span class="sc">*</span>out<span class="sc">$</span>se.fit)</span>
<span id="cb252-3"><a href="multilevel-modelling-practical-7-week-8.html#cb252-3" tabindex="-1"></a>leu<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">exp</span>(out<span class="sc">$</span>fit<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>out<span class="sc">$</span>se.fit)</span>
<span id="cb252-4"><a href="multilevel-modelling-practical-7-week-8.html#cb252-4" tabindex="-1"></a><span class="fu">ggplot</span>(leu,<span class="fu">aes</span>(<span class="at">x=</span>wbc,<span class="at">y=</span>time))<span class="sc">+</span></span>
<span id="cb252-5"><a href="multilevel-modelling-practical-7-week-8.html#cb252-5" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb252-6"><a href="multilevel-modelling-practical-7-week-8.html#cb252-6" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb252-7"><a href="multilevel-modelling-practical-7-week-8.html#cb252-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>wbc[<span class="fu">order</span>(wbc)],<span class="at">y=</span>pred[<span class="fu">order</span>(wbc)]))<span class="sc">+</span></span>
<span id="cb252-8"><a href="multilevel-modelling-practical-7-week-8.html#cb252-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;log(number of white blood cells)&quot;</span>)<span class="sc">+</span></span>
<span id="cb252-9"><a href="multilevel-modelling-practical-7-week-8.html#cb252-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;survival time&quot;</span>)</span></code></pre></div>
<img src="MLM_worksheets_files/figure-html/unnamed-chunk-164-1.png" width="672" />
</details>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="exercise-3-toxoplasmosis-data-binomial-logistic-regression" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Exercise 3: Toxoplasmosis data (Binomial logistic regression)<a href="multilevel-modelling-practical-7-week-8.html#exercise-3-toxoplasmosis-data-binomial-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The so-called rainfall or toxoplasmosis data give the number of subjects (<code>Cases</code>) out of (<code>Total</code>) testing positively for toxoplasmosis in each of 34 cities in El Salvador. The covariate <code>Rain</code> is the the annual rainfall in mm. Please load the data and carry out the following operation to create a variable <code>x</code> giving the annual rainfall per 1000mm:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="multilevel-modelling-practical-7-week-8.html#cb253-1" tabindex="-1"></a><span class="fu">require</span>(npmlreg)</span>
<span id="cb253-2"><a href="multilevel-modelling-practical-7-week-8.html#cb253-2" tabindex="-1"></a><span class="fu">data</span>(rainfall)</span>
<span id="cb253-3"><a href="multilevel-modelling-practical-7-week-8.html#cb253-3" tabindex="-1"></a>rainfall<span class="sc">$</span>x <span class="ot">&lt;-</span> rainfall<span class="sc">$</span>Rain<span class="sc">/</span><span class="dv">1000</span></span></code></pre></div>
<p>This is, again, an example for logistic regression. We want to model a probability of “success” (occurence of a binary event; here toxoplasmosis infection) as a function of covariates (here: <code>Rain</code>). However, here the situation is different to the <code>shuttle</code> example. Now the response is not just Bernoulli (failure or non-failure), but Binomial, where we have, for each observation, the number of Cases (<span class="math inline">\(y\)</span>) out of total tests carried out (<span class="math inline">\(n\)</span>). Note that the model is now <span class="math inline">\(Y \sim \text{Binomial}(n,\pi)\)</span>, where the observed ratio <span class="math inline">\(y/n\)</span> can be interpreted as an empirical estimate of the probability, <span class="math inline">\(\pi\)</span>, of “success”. The fitting methodology does however not use this ratio directly. One needs to give the full vectors of successes and non-successes, <span class="math inline">\(y\)</span> and <span class="math inline">\(n-y\)</span>, to <code>glm</code>, as follows:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="multilevel-modelling-practical-7-week-8.html#cb254-1" tabindex="-1"></a>toxo.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(Cases,Total<span class="sc">-</span>Cases) <span class="sc">~</span> x, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit), <span class="at">data=</span>rainfall)</span>
<span id="cb254-2"><a href="multilevel-modelling-practical-7-week-8.html#cb254-2" tabindex="-1"></a><span class="fu">summary</span>(toxo.glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cbind(Cases, Total - Cases) ~ x, family = binomial(link = logit), 
##     data = rainfall)
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)   0.3424     0.8522   0.402    0.688
## x            -0.1562     0.4428  -0.353    0.724
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 74.212  on 33  degrees of freedom
## Residual deviance: 74.087  on 32  degrees of freedom
## AIC: 168.78
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<p>An alternative way of supplying this information is as follows.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="multilevel-modelling-practical-7-week-8.html#cb256-1" tabindex="-1"></a><span class="fu">glm</span>(Cases<span class="sc">/</span>Total <span class="sc">~</span> x, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit), <span class="at">weights=</span>Total, <span class="at">data=</span>rainfall)</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = Cases/Total ~ x, family = binomial(link = logit), 
##     data = rainfall, weights = Total)
## 
## Coefficients:
## (Intercept)            x  
##      0.3424      -0.1562  
## 
## Degrees of Freedom: 33 Total (i.e. Null);  32 Residual
## Null Deviance:       74.21 
## Residual Deviance: 74.09     AIC: 168.8</code></pre>
<p><span class="math inline">\(~\)</span></p>
<p><strong>TASK:</strong> Check whether the model fit improves when including higher powers of <code>x</code> (quadratic, cubic,…). Consider the value of AIC to answer this question.</p>
<p><em>Hint:</em> Functions of variables can be included into the linear predictor using <code>I(.)</code>.</p>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="multilevel-modelling-practical-7-week-8.html#cb258-1" tabindex="-1"></a>toxo2.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Cases<span class="sc">/</span>Total <span class="sc">~</span> x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit), </span>
<span id="cb258-2"><a href="multilevel-modelling-practical-7-week-8.html#cb258-2" tabindex="-1"></a>                 <span class="at">weights=</span>  Total, <span class="at">data=</span>rainfall)</span>
<span id="cb258-3"><a href="multilevel-modelling-practical-7-week-8.html#cb258-3" tabindex="-1"></a></span>
<span id="cb258-4"><a href="multilevel-modelling-practical-7-week-8.html#cb258-4" tabindex="-1"></a>toxo2.glm</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = Cases/Total ~ x + I(x^2), family = binomial(link = logit), 
##     data = rainfall, weights = Total)
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    0.308739    -0.121636    -0.008778  
## 
## Degrees of Freedom: 33 Total (i.e. Null);  31 Residual
## Null Deviance:       74.21 
## Residual Deviance: 74.09     AIC: 170.8</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="multilevel-modelling-practical-7-week-8.html#cb260-1" tabindex="-1"></a>toxo3.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Cases<span class="sc">/</span>Total <span class="sc">~</span> x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>), <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span>logit),</span>
<span id="cb260-2"><a href="multilevel-modelling-practical-7-week-8.html#cb260-2" tabindex="-1"></a>                 <span class="at">weights=</span>  Total, <span class="at">data=</span>rainfall)</span>
<span id="cb260-3"><a href="multilevel-modelling-practical-7-week-8.html#cb260-3" tabindex="-1"></a>toxo3.glm</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = Cases/Total ~ x + I(x^2) + I(x^3), family = binomial(link = logit), 
##     data = rainfall, weights = Total)
## 
## Coefficients:
## (Intercept)            x       I(x^2)       I(x^3)  
##     -290.17       449.98      -231.13        39.32  
## 
## Degrees of Freedom: 33 Total (i.e. Null);  30 Residual
## Null Deviance:       74.21 
## Residual Deviance: 62.63     AIC: 161.3</code></pre>
We see a relatively big drop in AIC for the final model, so let’s go with <code>toxo.glm</code>.
</details>
<p><span class="math inline">\(~\)</span></p>
<p><strong>TASK:</strong> Using your model settled on just above, predict the ratio of toxoplasmosis infections for a city in El Salvador with annual rainfall of 2000mm.</p>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="multilevel-modelling-practical-7-week-8.html#cb262-1" tabindex="-1"></a><span class="fu">predict</span>(toxo3.glm, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">2</span>), <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##        1 
## 0.460961</code></pre>
</details>
<p><span class="math inline">\(~\)</span></p>
<p><strong>TASK:</strong> Compute the predicted toxoplasmsosis incidence as a function of rainfall. Plot the fitted curve versus rainfall.</p>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="multilevel-modelling-practical-7-week-8.html#cb264-1" tabindex="-1"></a>toxo3.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(toxo3.glm, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb264-2"><a href="multilevel-modelling-practical-7-week-8.html#cb264-2" tabindex="-1"></a>rainfall3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rainfall, toxo3.predict)</span>
<span id="cb264-3"><a href="multilevel-modelling-practical-7-week-8.html#cb264-3" tabindex="-1"></a><span class="fu">plot</span>(rainfall<span class="sc">$</span>x, rainfall<span class="sc">$</span>Cases<span class="sc">/</span>rainfall<span class="sc">$</span>Total, <span class="at">ylab=</span><span class="st">&quot;Cases/Total&quot;</span>)</span>
<span id="cb264-4"><a href="multilevel-modelling-practical-7-week-8.html#cb264-4" tabindex="-1"></a><span class="fu">lines</span>(rainfall<span class="sc">$</span>x[<span class="fu">order</span>(rainfall<span class="sc">$</span>x)], toxo3.predict[<span class="fu">order</span>(rainfall<span class="sc">$</span>x)])</span></code></pre></div>
<img src="MLM_worksheets_files/figure-html/unnamed-chunk-170-1.png" width="672" />
</details>
<p><span class="math inline">\(~\)</span></p>
<p><strong>TASK</strong>: Reproduce the plot using <code>ggplot2</code>.</p>
<details>
<summary>
Click for solution
</summary>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="multilevel-modelling-practical-7-week-8.html#cb265-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data  =</span> rainfall, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> Cases<span class="sc">/</span>Total)) <span class="sc">+</span></span>
<span id="cb265-2"><a href="multilevel-modelling-practical-7-week-8.html#cb265-2" tabindex="-1"></a>       <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb265-3"><a href="multilevel-modelling-practical-7-week-8.html#cb265-3" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&#39;red&#39;</span>, <span class="at">data =</span> rainfall3, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>toxo3.predict))</span></code></pre></div>
<img src="MLM_worksheets_files/figure-html/unnamed-chunk-171-1.png" width="672" />
</details>
<p><span class="math inline">\(~\)</span></p>
<p><strong>TASK (harder)</strong> Add confidence bands for the fitted curve to the just created plot. <em>Hint:</em> use <code>geom_smooth</code> with <code>method=glm</code> and specify a formula for the model.</p>
<details>
<summary>
Click for solution
</summary>
<p>Rather than obtain an interval for the linear predictor before running through the response function, we can use <code>geom_smooth</code>.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="multilevel-modelling-practical-7-week-8.html#cb266-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data  =</span> rainfall, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> Cases<span class="sc">/</span>Total)) <span class="sc">+</span></span>
<span id="cb266-2"><a href="multilevel-modelling-practical-7-week-8.html#cb266-2" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb266-3"><a href="multilevel-modelling-practical-7-week-8.html#cb266-3" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> glm,</span>
<span id="cb266-4"><a href="multilevel-modelling-practical-7-week-8.html#cb266-4" tabindex="-1"></a>                <span class="at">formula=</span><span class="fu">cbind</span>(rainfall<span class="sc">$</span>Cases,rainfall<span class="sc">$</span>Total<span class="sc">-</span>rainfall<span class="sc">$</span>Cases)<span class="sc">~</span></span>
<span id="cb266-5"><a href="multilevel-modelling-practical-7-week-8.html#cb266-5" tabindex="-1"></a>                    x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>), </span>
<span id="cb266-6"><a href="multilevel-modelling-practical-7-week-8.html#cb266-6" tabindex="-1"></a>                <span class="at">method.args=</span><span class="fu">list</span>(<span class="at">family=</span><span class="st">&quot;binomial&quot;</span>), </span>
<span id="cb266-7"><a href="multilevel-modelling-practical-7-week-8.html#cb266-7" tabindex="-1"></a>                <span class="at">se =</span> <span class="cn">TRUE</span>, </span>
<span id="cb266-8"><a href="multilevel-modelling-practical-7-week-8.html#cb266-8" tabindex="-1"></a>                <span class="at">size =</span> .<span class="dv">5</span>, </span>
<span id="cb266-9"><a href="multilevel-modelling-practical-7-week-8.html#cb266-9" tabindex="-1"></a>                <span class="at">alpha  =</span> .<span class="dv">8</span>)</span></code></pre></div>
<img src="MLM_worksheets_files/figure-html/unnamed-chunk-172-1.png" width="672" />
</details>
<p>How do you reconcile the relatively narrow bounds with the fact that so many observations lie scattered well outside those bounds?</p>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="end-of-lab-1" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> ## End of lab!<a href="multilevel-modelling-practical-7-week-8.html#end-of-lab-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multilevel-modelling-practical-6-week-7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multilevel-modelling-practical-8-week-9.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"sidebar": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
